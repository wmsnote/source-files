<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java Stream API 入门篇 | wums</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="wums note">
    <link rel="preload" href="/source-files/assets/css/0.styles.6eaab90e.css" as="style"><link rel="preload" href="/source-files/assets/js/app.b763afb2.js" as="script"><link rel="preload" href="/source-files/assets/js/2.a20b4d8f.js" as="script"><link rel="preload" href="/source-files/assets/js/39.1271fc22.js" as="script"><link rel="prefetch" href="/source-files/assets/js/10.b2fd2b20.js"><link rel="prefetch" href="/source-files/assets/js/100.950fa711.js"><link rel="prefetch" href="/source-files/assets/js/101.816d59c4.js"><link rel="prefetch" href="/source-files/assets/js/102.6d8cf1dc.js"><link rel="prefetch" href="/source-files/assets/js/103.faff5a55.js"><link rel="prefetch" href="/source-files/assets/js/104.5cae389c.js"><link rel="prefetch" href="/source-files/assets/js/105.74d0185a.js"><link rel="prefetch" href="/source-files/assets/js/106.afd2fd11.js"><link rel="prefetch" href="/source-files/assets/js/107.ff0c56c3.js"><link rel="prefetch" href="/source-files/assets/js/108.1035bb47.js"><link rel="prefetch" href="/source-files/assets/js/109.746c46a8.js"><link rel="prefetch" href="/source-files/assets/js/11.6cfeb465.js"><link rel="prefetch" href="/source-files/assets/js/12.f9fd9730.js"><link rel="prefetch" href="/source-files/assets/js/13.dd009f24.js"><link rel="prefetch" href="/source-files/assets/js/14.0233273d.js"><link rel="prefetch" href="/source-files/assets/js/15.8a3a0cdb.js"><link rel="prefetch" href="/source-files/assets/js/16.240b83af.js"><link rel="prefetch" href="/source-files/assets/js/17.d51ff9ca.js"><link rel="prefetch" href="/source-files/assets/js/18.9ebb0da4.js"><link rel="prefetch" href="/source-files/assets/js/19.367ba92d.js"><link rel="prefetch" href="/source-files/assets/js/20.86bbfae4.js"><link rel="prefetch" href="/source-files/assets/js/21.c93f8151.js"><link rel="prefetch" href="/source-files/assets/js/22.6a8d8dc7.js"><link rel="prefetch" href="/source-files/assets/js/23.d79240e5.js"><link rel="prefetch" href="/source-files/assets/js/24.30ee928b.js"><link rel="prefetch" href="/source-files/assets/js/25.0a8040de.js"><link rel="prefetch" href="/source-files/assets/js/26.df350862.js"><link rel="prefetch" href="/source-files/assets/js/27.89450194.js"><link rel="prefetch" href="/source-files/assets/js/28.294e3fc6.js"><link rel="prefetch" href="/source-files/assets/js/29.5d301e33.js"><link rel="prefetch" href="/source-files/assets/js/3.1496f34b.js"><link rel="prefetch" href="/source-files/assets/js/30.2cd75ac4.js"><link rel="prefetch" href="/source-files/assets/js/31.46490d17.js"><link rel="prefetch" href="/source-files/assets/js/32.c83ebc2d.js"><link rel="prefetch" href="/source-files/assets/js/33.f7a41714.js"><link rel="prefetch" href="/source-files/assets/js/34.90b3952e.js"><link rel="prefetch" href="/source-files/assets/js/35.398154b7.js"><link rel="prefetch" href="/source-files/assets/js/36.f56a5d5f.js"><link rel="prefetch" href="/source-files/assets/js/37.a95b4d21.js"><link rel="prefetch" href="/source-files/assets/js/38.6c2b1c96.js"><link rel="prefetch" href="/source-files/assets/js/4.6984b4d0.js"><link rel="prefetch" href="/source-files/assets/js/40.84ebd818.js"><link rel="prefetch" href="/source-files/assets/js/41.9f42589c.js"><link rel="prefetch" href="/source-files/assets/js/42.ebfa0f72.js"><link rel="prefetch" href="/source-files/assets/js/43.7480b80d.js"><link rel="prefetch" href="/source-files/assets/js/44.f7d82c69.js"><link rel="prefetch" href="/source-files/assets/js/45.b6c961ab.js"><link rel="prefetch" href="/source-files/assets/js/46.7f05c4ef.js"><link rel="prefetch" href="/source-files/assets/js/47.3ec256a4.js"><link rel="prefetch" href="/source-files/assets/js/48.61a96f42.js"><link rel="prefetch" href="/source-files/assets/js/49.a9054a50.js"><link rel="prefetch" href="/source-files/assets/js/5.62830c7d.js"><link rel="prefetch" href="/source-files/assets/js/50.2609d277.js"><link rel="prefetch" href="/source-files/assets/js/51.4877f05d.js"><link rel="prefetch" href="/source-files/assets/js/52.550e8c16.js"><link rel="prefetch" href="/source-files/assets/js/53.832161e7.js"><link rel="prefetch" href="/source-files/assets/js/54.6dac3cf6.js"><link rel="prefetch" href="/source-files/assets/js/55.737c80b3.js"><link rel="prefetch" href="/source-files/assets/js/56.17e79d68.js"><link rel="prefetch" href="/source-files/assets/js/57.25444e73.js"><link rel="prefetch" href="/source-files/assets/js/58.f46e9695.js"><link rel="prefetch" href="/source-files/assets/js/59.5c7f3c17.js"><link rel="prefetch" href="/source-files/assets/js/6.576f3577.js"><link rel="prefetch" href="/source-files/assets/js/60.7bc9b70e.js"><link rel="prefetch" href="/source-files/assets/js/61.9133e8a4.js"><link rel="prefetch" href="/source-files/assets/js/62.e34b4454.js"><link rel="prefetch" href="/source-files/assets/js/63.4a92432c.js"><link rel="prefetch" href="/source-files/assets/js/64.c538bedf.js"><link rel="prefetch" href="/source-files/assets/js/65.1e7cb3f2.js"><link rel="prefetch" href="/source-files/assets/js/66.1871ca26.js"><link rel="prefetch" href="/source-files/assets/js/67.a934e909.js"><link rel="prefetch" href="/source-files/assets/js/68.e2657924.js"><link rel="prefetch" href="/source-files/assets/js/69.7505e8c8.js"><link rel="prefetch" href="/source-files/assets/js/7.ad02f7a4.js"><link rel="prefetch" href="/source-files/assets/js/70.3bd6dee7.js"><link rel="prefetch" href="/source-files/assets/js/71.13824561.js"><link rel="prefetch" href="/source-files/assets/js/72.3a88b8e9.js"><link rel="prefetch" href="/source-files/assets/js/73.24135e51.js"><link rel="prefetch" href="/source-files/assets/js/74.5bc9f96e.js"><link rel="prefetch" href="/source-files/assets/js/75.6fef9340.js"><link rel="prefetch" href="/source-files/assets/js/76.05e1b555.js"><link rel="prefetch" href="/source-files/assets/js/77.415ae1c1.js"><link rel="prefetch" href="/source-files/assets/js/78.33573ec8.js"><link rel="prefetch" href="/source-files/assets/js/79.36e18488.js"><link rel="prefetch" href="/source-files/assets/js/8.e7a11f73.js"><link rel="prefetch" href="/source-files/assets/js/80.5a29c2ae.js"><link rel="prefetch" href="/source-files/assets/js/81.aba4b9bc.js"><link rel="prefetch" href="/source-files/assets/js/82.d97706e4.js"><link rel="prefetch" href="/source-files/assets/js/83.cabafa78.js"><link rel="prefetch" href="/source-files/assets/js/84.16af11d9.js"><link rel="prefetch" href="/source-files/assets/js/85.a7d61af7.js"><link rel="prefetch" href="/source-files/assets/js/86.2eecef68.js"><link rel="prefetch" href="/source-files/assets/js/87.0d7eda52.js"><link rel="prefetch" href="/source-files/assets/js/88.2e8f1557.js"><link rel="prefetch" href="/source-files/assets/js/89.107129ab.js"><link rel="prefetch" href="/source-files/assets/js/9.bc1abdf2.js"><link rel="prefetch" href="/source-files/assets/js/90.50719f11.js"><link rel="prefetch" href="/source-files/assets/js/91.ae9960a9.js"><link rel="prefetch" href="/source-files/assets/js/92.8d26bb2a.js"><link rel="prefetch" href="/source-files/assets/js/93.0a90b523.js"><link rel="prefetch" href="/source-files/assets/js/94.57737416.js"><link rel="prefetch" href="/source-files/assets/js/95.7ed73938.js"><link rel="prefetch" href="/source-files/assets/js/96.e5a63160.js"><link rel="prefetch" href="/source-files/assets/js/97.9ee50570.js"><link rel="prefetch" href="/source-files/assets/js/98.8a0dc25c.js"><link rel="prefetch" href="/source-files/assets/js/99.79f1cbd4.js">
    <link rel="stylesheet" href="/source-files/assets/css/0.styles.6eaab90e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/source-files/" class="home-link router-link-active"><!----> <span class="site-name">wums</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/source-files/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://gitee.com/wmsnote/dashboard/wikis" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WiKi
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://gitee.com/wmsnote/source-files" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitEE
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/source-files/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://gitee.com/wmsnote/dashboard/wikis" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WiKi
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://gitee.com/wmsnote/source-files" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitEE
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/shell/" class="sidebar-heading clickable"><span>shell</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/设计模式/" class="sidebar-heading clickable"><span>设计模式</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/prometheus/" class="sidebar-heading clickable"><span>prometheus</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/travis-ci/" class="sidebar-heading clickable"><span>travis-ci教程</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/Dockerfile/" class="sidebar-heading clickable"><span>Dockerfile</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/java/" class="sidebar-heading clickable router-link-active open"><span>Java教程</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/source-files/java/jdbc.html" class="sidebar-link">jdbc</a></li><li><a href="/source-files/java/apacheCommons.html" class="sidebar-link">apache-commons</a></li><li><a href="/source-files/java/optional.html" class="sidebar-link">java-8-Optional</a></li><li><a href="/source-files/java/泛型详解.html" class="sidebar-link">Java泛型详解</a></li><li><a href="/source-files/java/stream.html" class="active sidebar-link">JavaStreamAPI</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/source-files/java/stream.html#java-stream-api-入门篇" class="sidebar-link">Java Stream API 入门篇</a></li><li class="sidebar-sub-header"><a href="/source-files/java/stream.html#stream方法使用" class="sidebar-link">stream方法使用</a></li><li class="sidebar-sub-header"><a href="/source-files/java/stream.html#java-stream-api-进阶篇" class="sidebar-link">Java Stream API 进阶篇</a></li></ul></li><li><a href="/source-files/java/8新特性分析.html" class="sidebar-link">JAVA8新特性分析</a></li><li><a href="/source-files/java/多线程实现的三种方式.html" class="sidebar-link">Java多线程实现的三种方式</a></li><li><a href="/source-files/java/map遍历.html" class="sidebar-link">map遍历</a></li><li><a href="/source-files/java/spring扫描自定义注解并进行操作.html" class="sidebar-link">spring扫描自定义注解并进行操作</a></li><li><a href="/source-files/java/反射提高扩展性.html" class="sidebar-link">反射-提高扩展性</a></li><li><a href="/source-files/java/注解的定义和反射.html" class="sidebar-link">注解的定义和反射</a></li><li><a href="/source-files/java/获取指定包下所有自定义注解并提取注解信息.html" class="sidebar-link">获取指定包下所有自定义注解并提取注解信息</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/springboot2/" class="sidebar-heading clickable"><span>SpringBoot2.x</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/nginx/" class="sidebar-heading clickable"><span>nginx</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="java-stream-api-入门篇"><a href="#java-stream-api-入门篇" class="header-anchor">#</a> Java Stream API 入门篇</h2> <p><strong>代码简洁</strong>，函数式编程写出的代码简洁且意图明确，使用stream接口让你从此告别for循环。</p> <p><strong>多核友好</strong>，Java函数式编程使得编写并行程序从未如此简单，你需要的全部就是调用一下parallel()方法。</p> <p>stream并不是某种数据结构，它只是数据源的一种视图。这里的数据源可以是一个数组，Java容器或I/O channel等。正因如此要得到一个stream通常不会手动创建，而是调用对应的工具方法，比如：</p> <ul><li>调用Collection.stream()或者Collection.parallelStream()方法；</li> <li>调用Arrays.stream(T[] array)方法。</li></ul> <p>常见的stream接口继承关系如图：</p> <blockquote><p>为不同数据类型设置不同stream接口，可以1.提高性能，2.增加特定接口函数。</p></blockquote> <div class="language- line-numbers-mode"><pre class="language-text"><code>BaseStream

	|--	IntStream   int类型

	|--	LongStream   long类型

	|--	DoubleStream	double类型

	|--	Stream    其他类型

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>虽然大部分情况下stream是容器调用Collection.stream()方法得到的，但stream和collections有以下不同：</p> <ul><li><strong>无存储</strong>。stream不是一种数据结构，它只是某种数据源的一个视图，数据源可以是一个数组，Java容器或I/O channel等。</li> <li><strong>为函数式编程而生</strong>。对stream的任何修改都不会修改背后的数据源，比如对stream执行过滤操作并不会删除被过滤的元素，而是会产生一个不包含被过滤元素的新stream。</li> <li><strong>惰式执行</strong>。stream上的操作并不会立即执行，只有等到用户真正需要结果的时候才会执行。</li> <li><strong>可消费性</strong>。stream只能被“消费”一次，一旦遍历过就会失效，就像容器的迭代器那样，想要再次遍历必须重新生成。</li></ul> <p>对stream的操作分为为两类，<strong>中间操作(intermediate operations)和结束操作(terminal operations)</strong>，二者特点是：</p> <ol><li><strong>中间操作总是会惰式执行</strong>，调用中间操作只会生成一个标记了该操作的新stream，仅此而已。</li> <li><strong>结束操作会触发实际计算</strong>，计算发生时会把所有中间操作积攒的操作以pipeline的方式执行，这样可以减少迭代次数。计算完成之后stream就会失效。</li></ol> <table><thead><tr><th>操作类型</th> <th></th> <th>接口方法</th></tr></thead> <tbody><tr><td>中间操作</td> <td>无状态</td> <td>concat()  filter() flatMap() map() peek()  parallel() sequentila() unordered() mapToInt() mapToLong() mapToDouble() flatMapToInt()</td></tr> <tr><td></td> <td>有状态</td> <td>distinct() sorted() limit() skip()</td></tr> <tr><td>结束操作</td> <td>非短路</td> <td>collect() count() forEach() forEachOrdered() max() min() reduce() toArray()</td></tr> <tr><td></td> <td>短路</td> <td>allMatch() anyMatch() noneMatch() findFirst() fndAny()</td></tr></tbody></table> <blockquote><p>区分中间操作和结束操作最简单的方法，就是看方法的返回值，返回值为stream的大都是中间操作，否则是结束操作。</p></blockquote> <h2 id="stream方法使用"><a href="#stream方法使用" class="header-anchor">#</a> <strong>stream方法使用</strong></h2> <p>stream跟函数接口关系非常紧密，没有函数接口stream就无法工作。回顾一下：函数接口是指内部只有一个抽象方法的接口。通常函数接口出现的地方都可以使用Lambda表达式，所以不必记忆函数接口的名字。</p> <h3 id="max-最大元素"><a href="#max-最大元素" class="header-anchor">#</a> max()--最大元素</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> max <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span>s2<span class="token punctuation">)</span><span class="token operator">-&gt;</span>s1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>s2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">String</span> string <span class="token operator">=</span> max<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="findany-任一一元素"><a href="#findany-任一一元素" class="header-anchor">#</a> findAny()--任一一元素</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code>	<span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> optional <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>s<span class="token operator">-&gt;</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findAny</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">String</span> string <span class="token operator">=</span> optional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="anymatch-任一匹配"><a href="#anymatch-任一匹配" class="header-anchor">#</a> anyMatch()--任一匹配</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">boolean</span> allMatch <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">anyMatch</span><span class="token punctuation">(</span>s<span class="token operator">-&gt;</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="nonematch-无一匹配"><a href="#nonematch-无一匹配" class="header-anchor">#</a> noneMatch()--无一匹配</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code>stream<span class="token punctuation">.</span><span class="token function">noneMatch</span><span class="token punctuation">(</span>s<span class="token operator">-&gt;</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="allmatch-全部匹配"><a href="#allmatch-全部匹配" class="header-anchor">#</a> allMatch()--全部匹配</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code>stream<span class="token punctuation">.</span><span class="token function">allMatch</span><span class="token punctuation">(</span>s<span class="token operator">-&gt;</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="toarray-转成数组"><a href="#toarray-转成数组" class="header-anchor">#</a> toArray()--转成数组</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="foreachordered-遍历"><a href="#foreachordered-遍历" class="header-anchor">#</a> forEachOrdered()--遍历</h3> <blockquote><p>并行流中仍然按照原顺序遍历</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>x <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEachOrdered</span><span class="token punctuation">(</span>x <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="skip-去除前n个元素"><a href="#skip-去除前n个元素" class="header-anchor">#</a> skip()--去除前n个元素</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stream<span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">//截去前两个元素，只取后面的元素</span>
		<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="limit-指定元素大小"><a href="#limit-指定元素大小" class="header-anchor">#</a> limit()--指定元素大小</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code>	<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stream<span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">2l</span><span class="token punctuation">)</span><span class="token comment">//限制两个元素，只取前两个元素</span>
		<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="maptoint-元素转int"><a href="#maptoint-元素转int" class="header-anchor">#</a> mapToInt()--元素转int</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stream<span class="token punctuation">.</span><span class="token function">mapToInt</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">parseInt</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="parallel-并行流"><a href="#parallel-并行流" class="header-anchor">#</a> parallel()--并行流</h3> <blockquote><p>流可以是顺序的也可以是并行的。顺序流的操作是在单线程上执行的，而并行流的操作是在多线程上并发执行的。</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code>stream<span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="peek-遍历"><a href="#peek-遍历" class="header-anchor">#</a> peek()--遍历</h3> <blockquote><p>对stream中的每一个元素进行遍历消费，返回一个新流   Stream<T> peek(Consumer&lt;? super T&gt; action);</T></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code>	<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;love&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;you&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;too&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stream<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token class-name">TestM</span><span class="token operator">::</span><span class="token function">getStr</span><span class="token punctuation">)</span><span class="token comment">//中间操作</span>
          <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//结束操作</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="count-元素个数"><a href="#count-元素个数" class="header-anchor">#</a> count()--元素个数</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;love&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;you&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;too&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">long</span> count <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//4个元素</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="foreach-遍历"><a href="#foreach-遍历" class="header-anchor">#</a> <strong>forEach()</strong>--遍历</h3> <blockquote><p>我们对forEach()方法并不陌生，在Collection中我们已经见过。方法签名为void forEach(Consumer&lt;? super E&gt; action)，作用是对容器中的每个元素执行action指定的动作，也就是对元素进行遍历。</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code>		<span class="token comment">// 使用Stream.forEach()迭代</span>
		<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arry <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;love&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;you&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;too&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>arry<span class="token punctuation">)</span><span class="token punctuation">;</span>
		stream<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>str <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="filter-过滤"><a href="#filter-过滤" class="header-anchor">#</a> filter()--过滤</h3> <blockquote><p>函数原型为Stream<T> filter(Predicate&lt;? super T&gt; predicate)，作用是返回一个只包含满足predicate条件元素的Stream。</T></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code>		<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arry <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;love&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;you&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;too&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>arry<span class="token punctuation">)</span><span class="token punctuation">;</span>
		stream<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>str<span class="token operator">-&gt;</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token comment">//中间操作，过滤元素长度等于3的元素</span>
			  <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>str <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//最终操作</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="distinct-去重"><a href="#distinct-去重" class="header-anchor">#</a> distinct()--去重</h3> <blockquote><p>函数原型为Stream<T> distinct()，作用是返回一个去除重复元素之后的Stream</T></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code>		<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arry <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;love&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;you&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;too&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;too&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;you&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>arry<span class="token punctuation">)</span><span class="token punctuation">;</span>
		stream<span class="token punctuation">.</span><span class="token function">distinct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//中间操作,去除重复元素</span>
			  <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>str <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//最终操作</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="sorted-排序"><a href="#sorted-排序" class="header-anchor">#</a> <strong>sorted()--排序</strong></h3> <blockquote><p>排序函数有两个，一个是用自然顺序排序，一个是使用自定义比较器排序，函数原型分别为Stream<T>　sorted()和Stream<T>　sorted(Comparator&lt;? super T&gt; comparator)。</T></T></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code>		<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream<span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;love&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;you&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;too&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stream<span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">(</span>str1<span class="token punctuation">,</span> str2<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> str1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>str2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//中间操作，按元素长度排序</span>
		      <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>str <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//最终操作，遍历打印</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="map-转换"><a href="#map-转换" class="header-anchor">#</a> map()--转换</h3> <blockquote><p>函数原型为<R> Stream<R> map(Function&lt;? super T,? extends R&gt; mapper)，作用是返回一个对当前所有元素执行执行mapper之后的结果组成的Stream。直观的说，就是对每个元素按照某种操作进行转换，转换前后Stream中元素的个数不会改变，但元素的类型取决于转换之后的类型。</R></R></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code>		<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;love&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;you&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;too&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stream<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>str <span class="token operator">-&gt;</span> str<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//转换成大写</span>
		      <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>str <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="flatmap-合并"><a href="#flatmap-合并" class="header-anchor">#</a> flatMap()--合并</h3> <blockquote><p>函数原型为<R> Stream<R> flatMap(Function&lt;? super T,? extends Stream&lt;? extends R&gt;&gt; mapper)，作用是对每个元素执行mapper指定的操作，并用所有mapper返回的Stream中的元素组成一个新的Stream作为最终返回结果。说起来太拗口，通俗的讲flatMap()的作用就相当于把原stream中的所有元素都”摊平”之后组成的Stream，转换前后元素的个数和类型都可能会改变。</R></R></p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code>		<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stream<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>list <span class="token operator">-&gt;</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//转换到一个流</span>
    		  <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>i <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="java-stream-api-进阶篇"><a href="#java-stream-api-进阶篇" class="header-anchor">#</a> Java Stream API 进阶篇</h2> <p><strong>规约操作</strong>（reduction operation）又被称作折叠操作（fold），是通过某个连接动作将所有元素汇总成一个汇总结果的过程。元素求和、求最大值或最小值、求出元素总个数、将所有元素转换成一个列表或集合，都属于规约操作。Stream类库有两个通用的规约操作reduce()和collect()，也有一些为简化书写而设计的专用规约操作，比如sum()、max()、min()、count()等。</p> <p>最大或最小值这类规约操作很好理解（至少方法语义上是这样），我们着重介绍reduce()和collect()</p> <h3 id="reduce-生成一个值"><a href="#reduce-生成一个值" class="header-anchor">#</a> reduce()--生成一个值</h3> <p>reduce操作可以实现从一组元素中生成一个值，sum()、max()、min()、count()等都是reduce操作，将他们单独设为函数只是因为常用。</p> <p>reduce()的方法定义有三种重写形式：</p> <ul><li>Optional<T> reduce(BinaryOperator<T> accumulator)</T></T></li> <li>T reduce(T identity, BinaryOperator<T> accumulator)</T></li> <li><U> U reduce(U identity, BiFunction<U ,?="" super="" T,U=""> accumulator, BinaryOperator<U> combiner)
</U></U></U></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>Optional&lt;T&gt; reduce(BinaryOperator&lt;T&gt; accumulator)

我们先看第一个变形，其接受一个函数接口BinaryOperator&lt;T&gt;，而这个接口又继承于BiFunction&lt;T, T, T&gt;
BinaryOperator接口，可以看到reduce方法接受一个函数，这个函数有两个参数，第一个参数是上次函数执行的返回值（也称为中间结果），第二个参数是stream中的元素，这个函数把这两个值相加，得到的和会被赋值给下次执行这个函数的第一个参数。要注意的是：第一次执行的时候第一个参数的值是Stream的第一个元素，第二个参数是Stream的第二个元素
第一变形：未定义初始值，从而第一次执行的时候第一个参数的值是Stream的第一个元素，第二个参数是Stream的第二个元素

T reduce(T identity, BinaryOperator&lt;T&gt; accumulator)

第二个变形，与第一种变形相同的是都会接受一个BinaryOperator函数接口，不同的是其会接受一个identity参数，用来指定Stream循环的初始值。定义了初始值，从而第一次执行的时候第一个参数的值是初始值，第二个参数是Stream的第一个元素。如果Stream为空，就直接返回该值。另一方面，该方法不会返回Optional，因为该方法不会出现null。


&lt;U&gt; U reduce(U identity, BiFunction&lt;U,? super T,U&gt; accumulator, BinaryOperator&lt;U&gt; combiner)
Stream是支持并发操作的，为了避免竞争，对于reduce线程都会有独立的result，combiner的作用在于合并每个线程的result得到最终结果。这也说明了了第三个函数参数的数据类型必须为返回数据类型了。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>虽然函数定义越来越长，但语义不曾改变，多的参数只是为了指明初始值（参数identity），或者是指定并行执行时多个部分结果的合并方式（参数combiner）。reduce()最常用的场景就是从一堆值中生成一个值。用这么复杂的函数去求一个最大或最小值，你是不是觉得设计者有病。其实不然，因为“大”和“小”或者“求和”有时会有不同的语义。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;love&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;you&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;too&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> longest <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> s1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span>s2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> s1 <span class="token operator">:</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Optional&lt;String&gt; longest = stream.max((s1, s2) -&gt; s1.length()-s2.length());</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>longest<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上述代码会选出最长的单词love，其中Optional是（一个）值的容器，使用它可以避免null值的麻烦。当然可以使用Stream.max(Comparator&lt;? super T&gt; comparator)方法来达到同等效果，但reduce()自有其存在的理由。</p> <p>需求：求出一组单词的长度之和。这是个“求和”操作，操作对象输入类型是String，而结果类型是Integer。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 求单词长度之和</span>
<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;love&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;you&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;too&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Integer</span> lengthSum <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>　<span class="token comment">// 初始值　// (1)</span>
        <span class="token punctuation">(</span>sum<span class="token punctuation">,</span> str<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> sum<span class="token operator">+</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 累加器 // (2)</span>
        <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>　<span class="token comment">// 部分和拼接器，并行执行时才会用到 // (3)</span>
<span class="token comment">// int lengthSum = stream.mapToInt(str -&gt; str.length()).sum();</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>lengthSum<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>上述代码标号(2)处将i. 字符串映射成长度，ii. 并和当前累加和相加。这显然是两步操作，使用reduce()函数将这两步合二为一，更有助于提升性能。如果想要使用map()和sum()组合来达到上述目的，也是可以的。</p> <p>reduce()擅长的是生成一个值，如果想要从Stream生成一个集合或者Map等复杂的对象该怎么办呢？终极武器collect()横空出世！</p> <h3 id="collect-生成一个集合"><a href="#collect-生成一个集合" class="header-anchor">#</a> collect()--生成一个集合</h3> <h4 id="stream-collection"><a href="#stream-collection" class="header-anchor">#</a> Stream -&gt; collection</h4> <p>不夸张的讲，如果你发现某个功能在Stream接口中没找到，十有八九可以通过collect()方法实现。collect()是Stream接口方法中最灵活的一个，学会它才算真正入门Java函数式编程。先看几个热身的小例子：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>		<span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;love&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;you&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;too&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// stream -&gt; list</span>
		 <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> set <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Stream -&gt; set</span>
		 <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token punctuation">.</span><span class="token function">identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">::</span><span class="token function">length</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Stream -&gt; map</span>
		<span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> arrayList <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toCollection</span><span class="token punctuation">(</span><span class="token class-name">ArrayList</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Stream -&gt; arrayList</span>
		<span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> hashSet <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toCollection</span><span class="token punctuation">(</span><span class="token class-name">HashSet</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Stream -&gt; HashSet</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>上述代码分别列举了如何将Stream转换成List、Set和Map。虽然代码语义很明确，可是我们仍然会有几个疑问：</p> <ol><li>Function.identity()是干什么的？</li> <li>String::length是什么意思？</li> <li>Collectors是个什么东西？收集器（Collector）是为Stream.collect()方法量身打造的工具接口（类）</li></ol> <p><strong>接口的静态方法和默认方法</strong></p> <p>Function是一个接口，那么Function.identity()是什么意思呢？这要从两方面解释：</p> <ol><li>Java 8允许在接口中加入具体方法。接口中的具体方法有两种，default方法和static方法，identity()就是Function接口的一个静态方法。</li> <li>Function.identity()返回一个输出跟输入一样的Lambda表达式对象，等价于形如t -&gt; t形式的Lambda表达式。</li></ol> <p><strong>方法引用</strong></p> <p>诸如String::length的语法形式叫做方法引用（method references），这种语法用来替代某些特定形式Lambda表达式。如果Lambda表达式的全部内容就是调用一个已有的方法，那么可以用方法引用来替代Lambda表达式。方法引用可以细分为四类：</p> <table><thead><tr><th>方法引用的类别</th> <th>举例</th></tr></thead> <tbody><tr><td>引用静态方法</td> <td>Integer::sum</td></tr> <tr><td>应用对象方法</td> <td>list::add</td></tr> <tr><td>应用某个类的方法</td> <td>String::length</td></tr> <tr><td>应用构造方法</td> <td>HashMap::new</td></tr></tbody></table> <h4 id="stream-map"><a href="#stream-map" class="header-anchor">#</a> Stream -&gt; map</h4> <p>前面已经说过Stream背后依赖于某种数据源，数据源可以是数组、容器等，但不能是Map。反过来从Stream生成Map是可以的，但我们要想清楚Map的key和value分别代表什么，根本原因是我们要想清楚要干什么。通常在三种情况下collect()的结果会是Map：</p> <ol><li>使用Collectors.toMap()生成的收集器，用户需要指定如何生成Map的key和value。</li> <li>使用Collectors.partitioningBy()生成的收集器，对元素进行二分区操作时用到。</li> <li>使用Collectors.groupingBy()生成的收集器，对元素做group操作时用到。</li></ol> <p>情况1：使用toMap()生成的收集器，这种情况是最直接的，前面例子中已提到，这是和Collectors.toCollection()并列的方法。如下代码展示将学生列表转换成由&lt;学生，GPA&gt;组成的Map。非常直观，无需多言。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 使用toMap()统计学生GPA</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> studentToGPA <span class="token operator">=</span>students<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>
  					<span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span>
                      	<span class="token class-name">Functions</span><span class="token punctuation">.</span><span class="token function">identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// 如何生成key</span>
                      	student <span class="token operator">-&gt;</span> <span class="token function">computeGPA</span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token comment">// 如何生成value</span>
                    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>情况2：使用partitioningBy()生成的收集器，这种情况适用于将Stream中的元素依据某个二值逻辑（满足条件，或不满足）分成互补相交的两部分，比如男女性别、成绩及格与否等。下列代码展示将学生分成成绩及格或不及格的两部分。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Partition students into passing and failing</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> passingFailing <span class="token operator">=</span> students<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">partitioningBy</span><span class="token punctuation">(</span>s <span class="token operator">-&gt;</span> s<span class="token punctuation">.</span><span class="token function">getGrade</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> PASS_THRESHOLD<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>情况3：使用groupingBy()生成的收集器，这是比较灵活的一种情况。跟SQL中的group by语句类似，这里的groupingBy()也是按照某个属性对数据进行分组，属性相同的元素会被对应到Map的同一个key上。下列代码展示将员工按照部门进行分组：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Group employees by department</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Department</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> byDept <span class="token operator">=</span> employees<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token operator">::</span><span class="token function">getDepartment</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>以上只是分组的最基本用法，有些时候仅仅分组是不够的。在SQL中使用group by是为了协助其他查询，比如1. 先将员工按照部门分组，2. 然后统计每个部门员工的人数。Java类库设计者也考虑到了这种情况，增强版的groupingBy()能够满足这种需求。增强版的groupingBy()允许我们对元素分组之后再执行某种运算，比如求和、计数、平均值、类型转换等。这种先将元素分组的收集器叫做上游收集器，之后执行其他运算的收集器叫做下游收集器(downstream Collector)。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 使用下游收集器统计每个部门的人数</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Department</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> totalByDept <span class="token operator">=</span> employees<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token operator">::</span><span class="token function">getDepartment</span><span class="token punctuation">,</span>
                                                   <span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">counting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 下游收集器</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上面代码的逻辑是不是越看越像SQL？高度非结构化。还有更狠的，下游收集器还可以包含更下游的收集器，这绝不是为了炫技而增加的把戏，而是实际场景需要。考虑将员工按照部门分组的场景，如果我们想得到每个员工的名字（字符串），而不是一个个Employee对象，可通过如下方式做到：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 按照部门对员工分布组，并只保留员工的名字</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Department</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> byDept <span class="token operator">=</span> employees<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">groupingBy</span><span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token operator">::</span><span class="token function">getDepartment</span><span class="token punctuation">,</span>
                        <span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">mapping</span><span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token operator">::</span><span class="token function">getName</span><span class="token punctuation">,</span><span class="token comment">// 下游收集器</span>
                                <span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 更下游的收集器</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="拼接字符串"><a href="#拼接字符串" class="header-anchor">#</a> 拼接字符串</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 使用Collectors.joining()拼接字符串</span>
		 <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;love&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;you&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		 <span class="token comment">//String joined = stream.collect(Collectors.joining());// &quot;Iloveyou&quot;</span>
		 <span class="token comment">//String joined = stream.collect(Collectors.joining(&quot;,&quot;));// &quot;I,love,you&quot;</span>
		 <span class="token class-name">String</span> joined <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">joining</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;{&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// &quot;{I,love,you}&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/24/2020, 6:50:47 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/source-files/java/泛型详解.html" class="prev">
        Java泛型详解
      </a></span> <span class="next"><a href="/source-files/java/8新特性分析.html">
        JAVA8新特性分析
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/source-files/assets/js/app.b763afb2.js" defer></script><script src="/source-files/assets/js/2.a20b4d8f.js" defer></script><script src="/source-files/assets/js/39.1271fc22.js" defer></script>
  </body>
</html>
