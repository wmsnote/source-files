(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{329:function(s,t,a){s.exports=a.p+"assets/img/two_level_produce.9a671b41.png"},373:function(s,t,a){"use strict";a.r(t);var e=a(9),v=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("##　二级缓存")]),s._v(" "),e("p",[s._v("工作中很少用，因为有一些弊端(脏读,单线程,多线程,多实例)")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://wums.oss-cn-beijing.aliyuncs.com/mybatis/20200512103722.png",alt:""}})]),s._v(" "),e("p",[e("img",{attrs:{src:"https://wums.oss-cn-beijing.aliyuncs.com/mybatis/20200512103854.png",alt:""}})]),s._v(" "),e("p",[e("img",{attrs:{src:"https://wums.oss-cn-beijing.aliyuncs.com/mybatis/20200512104027.png",alt:""}})]),s._v(" "),e("blockquote",[e("p",[s._v("很重要：po需要实现序列化接口\n一级缓存在同一个sqlSession内，二级缓存在同一个sqlSessionFactory内")])]),s._v(" "),e("h2",{attrs:{id:"二级缓存的命中原则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二级缓存的命中原则"}},[s._v("#")]),s._v(" 二级缓存的命中原则")]),s._v(" "),e("p",[s._v("同一个sqlSessionFactory内\n两次查询是完全相同的查询且有缓存.")]),s._v(" "),e("p",[s._v("完全相同的查询:")]),s._v(" "),e("ol",[e("li",[s._v("statementId必须相同否则无法命中缓存,即使sql语句和参数完全相同")]),s._v(" "),e("li",[s._v("查询参数全完相同(这里的查询参数是sql语句参数)")]),s._v(" "),e("li",[s._v("分页参数必须相同(缓存的粒度是整个分页结果,不是结果中的每条)")]),s._v(" "),e("li",[s._v("传递给sql语句的文本必须一样")]),s._v(" "),e("li",[s._v("环境必须一样(dev/stage/prod不同环境不同的sql)")])]),s._v(" "),e("blockquote",[e("p",[s._v("和一级缓存的命中原则完全一样")])]),s._v(" "),e("h2",{attrs:{id:"二级缓存的声明周期"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二级缓存的声明周期"}},[s._v("#")]),s._v(" 二级缓存的声明周期")]),s._v(" "),e("p",[s._v("产生:")]),s._v(" "),e("ol",[e("li",[s._v("满足一级缓存的产生条件,在sql执行select后")]),s._v(" "),e("li",[s._v("session.commit或者close后")])]),s._v(" "),e("p",[e("img",{attrs:{src:a(329),alt:""}})]),s._v(" "),e("h2",{attrs:{id:"总结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结:")]),s._v(" "),e("p",[s._v("一级缓存,放心大胆的用,不会产生脏读(事物范围内),默认开启,然而没啥卵用(正因为在一个事物内,出现重复一模一样的查询基本不会出现)\n二级缓存,小心谨慎使用或者直接不用,默认不开启,因为不管是单线程多线程多实例都会出现脏读问题,直接不用")])])}),[],!1,null,null,null);t.default=v.exports}}]);