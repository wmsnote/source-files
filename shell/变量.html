<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>wums</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="wums note">
    <link rel="preload" href="/source-files/assets/css/0.styles.65bc254d.css" as="style"><link rel="preload" href="/source-files/assets/js/app.4b1e3a52.js" as="script"><link rel="preload" href="/source-files/assets/js/2.6ef31ef9.js" as="script"><link rel="preload" href="/source-files/assets/js/38.190c2d90.js" as="script"><link rel="prefetch" href="/source-files/assets/js/10.bb5c8724.js"><link rel="prefetch" href="/source-files/assets/js/11.e406a39f.js"><link rel="prefetch" href="/source-files/assets/js/12.61ba9b2e.js"><link rel="prefetch" href="/source-files/assets/js/13.af2d72b3.js"><link rel="prefetch" href="/source-files/assets/js/14.36234bf7.js"><link rel="prefetch" href="/source-files/assets/js/15.c394e3d4.js"><link rel="prefetch" href="/source-files/assets/js/16.be6df2db.js"><link rel="prefetch" href="/source-files/assets/js/17.9e8ceedd.js"><link rel="prefetch" href="/source-files/assets/js/18.e1c0321a.js"><link rel="prefetch" href="/source-files/assets/js/19.2da74833.js"><link rel="prefetch" href="/source-files/assets/js/20.e5673162.js"><link rel="prefetch" href="/source-files/assets/js/21.fde8fbc4.js"><link rel="prefetch" href="/source-files/assets/js/22.c696124c.js"><link rel="prefetch" href="/source-files/assets/js/23.6938e972.js"><link rel="prefetch" href="/source-files/assets/js/24.68bdbc44.js"><link rel="prefetch" href="/source-files/assets/js/25.5fc89cba.js"><link rel="prefetch" href="/source-files/assets/js/26.32bc76c7.js"><link rel="prefetch" href="/source-files/assets/js/27.d5763558.js"><link rel="prefetch" href="/source-files/assets/js/28.f400960f.js"><link rel="prefetch" href="/source-files/assets/js/29.607c4ce0.js"><link rel="prefetch" href="/source-files/assets/js/3.73f3b87a.js"><link rel="prefetch" href="/source-files/assets/js/30.d44aeed2.js"><link rel="prefetch" href="/source-files/assets/js/31.27cb68c7.js"><link rel="prefetch" href="/source-files/assets/js/32.c52a0fdd.js"><link rel="prefetch" href="/source-files/assets/js/33.92eda0d8.js"><link rel="prefetch" href="/source-files/assets/js/34.d09beb0c.js"><link rel="prefetch" href="/source-files/assets/js/35.38196f56.js"><link rel="prefetch" href="/source-files/assets/js/36.1fa99c4e.js"><link rel="prefetch" href="/source-files/assets/js/37.29b4d36e.js"><link rel="prefetch" href="/source-files/assets/js/39.aece2dc6.js"><link rel="prefetch" href="/source-files/assets/js/4.d76f0767.js"><link rel="prefetch" href="/source-files/assets/js/40.5fe0f064.js"><link rel="prefetch" href="/source-files/assets/js/41.56e73a65.js"><link rel="prefetch" href="/source-files/assets/js/42.8f62fbd5.js"><link rel="prefetch" href="/source-files/assets/js/43.bb8ba23e.js"><link rel="prefetch" href="/source-files/assets/js/44.f9301cf3.js"><link rel="prefetch" href="/source-files/assets/js/45.a5ff9d04.js"><link rel="prefetch" href="/source-files/assets/js/46.56c3b214.js"><link rel="prefetch" href="/source-files/assets/js/47.8debe662.js"><link rel="prefetch" href="/source-files/assets/js/48.8d8849f3.js"><link rel="prefetch" href="/source-files/assets/js/49.b471d69d.js"><link rel="prefetch" href="/source-files/assets/js/5.17e27241.js"><link rel="prefetch" href="/source-files/assets/js/50.ab7c90c4.js"><link rel="prefetch" href="/source-files/assets/js/51.efc42901.js"><link rel="prefetch" href="/source-files/assets/js/52.13960dbb.js"><link rel="prefetch" href="/source-files/assets/js/53.1978d569.js"><link rel="prefetch" href="/source-files/assets/js/54.82c576e2.js"><link rel="prefetch" href="/source-files/assets/js/55.cb950191.js"><link rel="prefetch" href="/source-files/assets/js/56.b53ad1d9.js"><link rel="prefetch" href="/source-files/assets/js/57.1f220dec.js"><link rel="prefetch" href="/source-files/assets/js/58.535d49f5.js"><link rel="prefetch" href="/source-files/assets/js/59.2adbb04a.js"><link rel="prefetch" href="/source-files/assets/js/6.ea86a040.js"><link rel="prefetch" href="/source-files/assets/js/60.e16caee2.js"><link rel="prefetch" href="/source-files/assets/js/61.7db157d7.js"><link rel="prefetch" href="/source-files/assets/js/62.2e93d821.js"><link rel="prefetch" href="/source-files/assets/js/63.15a4418f.js"><link rel="prefetch" href="/source-files/assets/js/64.10f946b1.js"><link rel="prefetch" href="/source-files/assets/js/65.7d9d057d.js"><link rel="prefetch" href="/source-files/assets/js/7.e5cd0322.js"><link rel="prefetch" href="/source-files/assets/js/8.bef3d365.js"><link rel="prefetch" href="/source-files/assets/js/9.28ed91f3.js">
    <link rel="stylesheet" href="/source-files/assets/css/0.styles.65bc254d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/source-files/" class="home-link router-link-active"><!----> <span class="site-name">wums</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/source-files/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://gitee.com/wmsnote/dashboard/wikis" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WiKi
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://gitee.com/wmsnote/source-files" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitEE
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/source-files/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://gitee.com/wmsnote/dashboard/wikis" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WiKi
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://gitee.com/wmsnote/source-files" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitEE
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/shell/" class="sidebar-heading clickable router-link-active open"><span>shell</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/source-files/shell/Bash简介.html" class="sidebar-link">Bash简介</a></li><li><a href="/source-files/shell/基本语法.html" class="sidebar-link">基本语法</a></li><li><a href="/source-files/shell/Bash的模式扩展.html" class="sidebar-link">Bash的模式扩展</a></li><li><a href="/source-files/shell/引号和转义.html" class="sidebar-link">引号和转义</a></li><li><a href="/source-files/shell/变量.html" class="active sidebar-link">变量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/source-files/shell/变量.html#_1-简介" class="sidebar-link">1. 简介</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/变量.html#_2-创建变量" class="sidebar-link">2. 创建变量</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/变量.html#_3-读取变量" class="sidebar-link">3. 读取变量</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/变量.html#_4-删除变量" class="sidebar-link">4. 删除变量</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/变量.html#_5-输出变量，export-命令" class="sidebar-link">5. 输出变量，export 命令</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/变量.html#_6-特殊变量" class="sidebar-link">6. 特殊变量</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/变量.html#_7-变量的默认值" class="sidebar-link">7. 变量的默认值</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/变量.html#_8-declare-命令" class="sidebar-link">8. declare 命令</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/变量.html#_9-readonly-命令" class="sidebar-link">9. readonly 命令</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/变量.html#_10-let-命令" class="sidebar-link">10. let 命令</a></li></ul></li><li><a href="/source-files/shell/字符串操作.html" class="sidebar-link">字符串操作</a></li><li><a href="/source-files/shell/算数运算.html" class="sidebar-link">算数运算</a></li><li><a href="/source-files/shell/Bash行操作.html" class="sidebar-link">Bash行操作</a></li><li><a href="/source-files/shell/目录堆栈.html" class="sidebar-link">目录堆栈</a></li><li><a href="/source-files/shell/Bash脚本入门.html" class="sidebar-link">Bash脚本入门</a></li><li><a href="/source-files/shell/read命令.html" class="sidebar-link">read命令</a></li><li><a href="/source-files/shell/条件判断.html" class="sidebar-link">条件判断</a></li><li><a href="/source-files/shell/循环.html" class="sidebar-link">循环</a></li><li><a href="/source-files/shell/函数.html" class="sidebar-link">函数</a></li><li><a href="/source-files/shell/数组.html" class="sidebar-link">数组</a></li><li><a href="/source-files/shell/set.html" class="sidebar-link">set命令</a></li><li><a href="/source-files/shell/脚本除错.html" class="sidebar-link">脚本除错</a></li><li><a href="/source-files/shell/mktemp_and_trap.html" class="sidebar-link">mktemp命令和trap命令</a></li><li><a href="/source-files/shell/Bash启动环境.html" class="sidebar-link">Bash启动环境</a></li><li><a href="/source-files/shell/命令提示符.html" class="sidebar-link">命令提示符</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/设计模式/" class="sidebar-heading clickable"><span>设计模式</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/prometheus/" class="sidebar-heading clickable"><span>prometheus</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/travis-ci/" class="sidebar-heading clickable"><span>travis-ci教程</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/Dockerfile/" class="sidebar-heading clickable"><span>Dockerfile</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/java/" class="sidebar-heading clickable"><span>Java教程</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/springboot2/" class="sidebar-heading clickable"><span>SpringBoot2.x</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/nginx/" class="sidebar-heading clickable"><span>nginx</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>Bash 变量分成环境变量和自定义变量两类。</p> <h2 id="_1-简介"><a href="#_1-简介" class="header-anchor">#</a> 1. 简介</h2> <p>环境变量是 Bash 环境自带的变量，进入 Shell 时已经定义好了，可以直接使用。它们通常是系统定义好的，也可以由用户从父 Shell 传入子 Shell。</p> <p>env命令或printenv命令，可以显示所有环境变量。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">env</span>

$ <span class="token function">printenv</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>下面是一些常见的环境变量。</p> <table><thead><tr><th>ENV</th> <th>含义</th></tr></thead> <tbody><tr><td>BASHPID</td> <td>Bash 进程的进程 ID。</td></tr> <tr><td>BASHOPTS</td> <td>当前 Shell 的参数，可以用shopt命令修改。</td></tr> <tr><td>DISPLAY</td> <td>图形环境的显示器名字，通常是:0，表示 X Server 的第一个显示器。</td></tr> <tr><td>EDITOR</td> <td>默认的文本编辑器。</td></tr> <tr><td>HOME</td> <td>用户的主目录。</td></tr> <tr><td>HOST</td> <td>当前主机的名称。</td></tr> <tr><td>IFS</td> <td>词与词之间的分隔符，默认为空格。</td></tr> <tr><td>LANG</td> <td>字符集以及语言编码，比如zh_CN.UTF-8。</td></tr> <tr><td>PATH</td> <td>由冒号分开的目录列表，当输入可执行程序名后，会搜索这个目录列表。</td></tr> <tr><td>PS1</td> <td>Shell 提示符。</td></tr> <tr><td>PS2：</td> <td>输入多行命令时，次要的 Shell 提示符。</td></tr> <tr><td>PWD</td> <td>当前工作目录。</td></tr> <tr><td>RANDOM</td> <td>返回一个0到32767之间的随机数。</td></tr> <tr><td>SHELL</td> <td>Shell 的名字。</td></tr> <tr><td>SHELLOPTS</td> <td>启动当前 Shell 的set命令的参数，参见《set 命令》一章。</td></tr> <tr><td>TERM</td> <td>终端类型名，即终端仿真器所用的协议。</td></tr> <tr><td>UID</td> <td>当前用户的 ID 编号。</td></tr> <tr><td>USER</td> <td>当前用户的用户名。</td></tr></tbody></table> <p>很多环境变量很少发生变化，而且是只读的，可以视为常量。由于它们的变量名全部都是大写，所以传统上，如果用户要自己定义一个常量，也会使用全部大写的变量名</p> <p>注意，Bash 变量名区分大小写，HOME和home是两个不同的变量。</p> <p>查看单个环境变量的值，可以使用printenv命令或echo命令。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">printenv</span> <span class="token environment constant">PATH</span>

$ <span class="token builtin class-name">echo</span> <span class="token environment constant">$PATH</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>注意，printenv命令后面的变量名，不用加前缀<code>$</code></strong></p> <p>自定义变量是用户在当前 Shell 里面自己定义的变量，必须先定义后使用，而且仅在当前 Shell 可用。一旦退出当前 Shell，该变量就不存在了。</p> <p>set命令可以显示所有变量（包括环境变量和自定义变量），以及所有的 Bash 函数。</p> <p><code>$ set</code></p> <h2 id="_2-创建变量"><a href="#_2-创建变量" class="header-anchor">#</a> 2. 创建变量</h2> <p>用户创建变量的时候，变量名必须遵守下面的规则。</p> <ol><li>字母、数字和下划线字符组成。</li> <li>第一个字符必须是一个字母或一个下划线，不能是数字。</li> <li>不允许出现空格和标点符号。</li></ol> <p>变量声明的语法如下。</p> <p><code>variable=value</code></p> <p>上面命令中，等号左边是变量名，右边是变量。<strong>注意，等号两边不能有空格。</strong></p> <p>如果变量的值包含空格，则必须将值放在引号中。</p> <p><code>myvar=&quot;hello world&quot;</code></p> <p>Bash 没有数据类型的概念，所有的变量值都是字符串。</p> <p>下面是一些自定义变量的例子。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token assign-left variable">a</span><span class="token operator">=</span>z
<span class="token assign-left variable">b</span><span class="token operator">=</span><span class="token string">&quot;a string&quot;</span>
<span class="token assign-left variable">c</span><span class="token operator">=</span><span class="token string">&quot;a string and <span class="token variable">$b</span>&quot;</span>
<span class="token assign-left variable">d</span><span class="token operator">=</span><span class="token string">&quot;<span class="token entity" title="\t">\t</span><span class="token entity" title="\t">\t</span>a string<span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token assign-left variable">e</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> -l foo.txt<span class="token variable">)</span></span>
<span class="token assign-left variable">f</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token number">7</span><span class="token variable">))</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>变量可以重复赋值，后面的赋值会覆盖前面的赋值。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token assign-left variable">foo</span><span class="token operator">=</span><span class="token number">1</span>
$ <span class="token assign-left variable">foo</span><span class="token operator">=</span><span class="token number">2</span>
$ <span class="token builtin class-name">echo</span> <span class="token variable">$foo</span>
<span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上面例子中，变量foo的第二次赋值会覆盖第一次赋值。</p> <h2 id="_3-读取变量"><a href="#_3-读取变量" class="header-anchor">#</a> 3. 读取变量</h2> <p>读取变量的时候，直接在变量名前加上$就可以了。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token assign-left variable">foo</span><span class="token operator">=</span>bar
$ <span class="token builtin class-name">echo</span> <span class="token variable">$foo</span>
bar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>每当 Shell 看到以<code>$</code>开头的单词时，就会尝试读取这个变量名对应的值。</p> <p>如果变量不存在，Bash 不会报错，而会输出空字符。</p> <p>由于$在 Bash 中有特殊含义，把它当作美元符号使用时，一定要非常小心，</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">echo</span> The total is <span class="token variable">$100</span>.00
The total is 00.00
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面命令的原意是输入<code>$100</code>，但是 Bash 将<code>$1</code>解释成了变量，该变量为空，因此输入就变成了<code>00.00</code>。
所以，如果要使用$的原义，需要在$前面放上反斜杠，进行转义。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">echo</span> The total is <span class="token punctuation">\</span><span class="token variable">$100</span>.00
The total is <span class="token variable">$100</span>.00
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>读取变量的时候，变量名也可以使用花括号{}包围，比如$a也可以写成${a}。这种写法可以用于变量名与其他字符连用的情况。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token assign-left variable">a</span><span class="token operator">=</span>foo
$ <span class="token builtin class-name">echo</span> <span class="token variable">$a_file</span>

$ <span class="token builtin class-name">echo</span> <span class="token variable">${a}</span>_file
foo_file
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面代码中，变量名a_file不会有任何输出，因为 Bash 将其整个解释为变量，而这个变量是不存在的。只有用花括号区分$a，Bash 才能正确解读。</p> <p>事实上，读取变量的语法$foo，可以看作是${foo}的简写形式。</p> <p>如果变量的值本身也是变量，可以使用<code>${!varname}</code>的语法，读取最终的值。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token assign-left variable">myvar</span><span class="token operator">=</span><span class="token environment constant">USER</span>
$ <span class="token builtin class-name">echo</span> <span class="token variable">${<span class="token operator">!</span>myvar}</span>
ruanyf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>上面的例子中，变量myvar的值是USER，${!myvar}的写法将其展开成最终的值。</p> <h2 id="_4-删除变量"><a href="#_4-删除变量" class="header-anchor">#</a> 4. 删除变量</h2> <p>unset命令用来删除一个变量。</p> <p><code>unset NAME</code></p> <p>这个命令不是很有用。因为不存在的 Bash 变量一律等于空字符串，所以即使unset命令删除了变量，还是可以读取这个变量，值为空字符串。</p> <p>所以，删除一个变量，也可以将这个变量设成空字符串。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token assign-left variable">foo</span><span class="token operator">=</span><span class="token string">''</span>
$ <span class="token assign-left variable">foo</span><span class="token operator">=</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面两种写法，都是删除了变量foo。由于不存在的值默认为空字符串，所以后一种写法可以在等号右边不写任何值。</p> <h2 id="_5-输出变量，export-命令"><a href="#_5-输出变量，export-命令" class="header-anchor">#</a> 5. 输出变量，export 命令</h2> <p>用户创建的变量仅可用于当前 Shell，子 Shell 默认读取不到父 Shell 定义的变量。为了把变量传递给子 Shell，需要使用export命令。
这样输出的变量，对于子 Shell 来说就是环境变量。</p> <p>export命令用来向子 Shell 输出变量。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable">NAME</span><span class="token operator">=</span>foo
<span class="token builtin class-name">export</span> NAME
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面命令输出了变量NAME。变量的赋值和输出也可以在一个步骤中完成。</p> <p><code>export NAME=value</code></p> <p>上面命令执行后，当前 Shell 及随后新建的子 Shell，都可以读取变量<code>$NAME</code>。</p> <p>子 Shell 如果修改继承的变量，不会影响父 Shell。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">export</span> <span class="token assign-left variable">foo</span><span class="token operator">=</span>bar
$ <span class="token function">bash</span>
$ <span class="token builtin class-name">echo</span> <span class="token variable">$foo</span>
bar
$ <span class="token assign-left variable">foo</span><span class="token operator">=</span>baz
$ <span class="token builtin class-name">exit</span>
$ <span class="token builtin class-name">echo</span> <span class="token variable">$foo</span>
bar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>上面例子中，子 Shell 修改了继承的变量$foo，对父 Shell 没有影响。</p> <h2 id="_6-特殊变量"><a href="#_6-特殊变量" class="header-anchor">#</a> 6. 特殊变量</h2> <p>Bash 提供一些特殊变量。这些变量的值由 Shell 提供，用户不能进行赋值。</p> <h3 id="（1）"><a href="#（1）" class="header-anchor">#</a> （1）$?</h3> <p><code>$?</code>为上一个命令的退出码，用来判断上一个命令是否执行成功。返回值是0，表示上一个命令执行成功；如果是非零，上一个命令执行失败。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ls</span> doesnotexist
ls: doesnotexist: No such <span class="token function">file</span> or directory

$ <span class="token builtin class-name">echo</span> <span class="token variable">$?</span>
<span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面例子中，ls命令查看一个不存在的文件，导致报错。$?为1，表示上一个命令执行失败。</p> <h3 id="（2）"><a href="#（2）" class="header-anchor">#</a> （2）$</h3> <p><code>$</code>为当前 Shell 的进程 ID。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">echo</span> $
<span class="token number">10662</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>这个特殊变量可以用来命名临时文件。</p></blockquote> <p><code>LOGFILE=/tmp/output_log.$</code></p> <h3 id="（3）"><a href="#（3）" class="header-anchor">#</a> （3）$_</h3> <p><code>$_</code>为上一个命令的最后一个参数。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">grep</span> dictionary /usr/share/dict/words
dictionary

$ <span class="token builtin class-name">echo</span> <span class="token variable">$_</span>
/usr/share/dict/words
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="（4）"><a href="#（4）" class="header-anchor">#</a> （4）$!</h3> <p><code>$!</code>为最近一个后台执行的异步命令的进程 ID。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ firefox <span class="token operator">&amp;</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token number">11064</span>

$ <span class="token builtin class-name">echo</span> <span class="token variable">$!</span>
<span class="token number">11064</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面例子中，firefox是后台运行的命令，<code>$!</code>返回该命令的进程 ID。</p> <h3 id="（5）-0"><a href="#（5）-0" class="header-anchor">#</a> （5）$0</h3> <p><code>$0</code>为当前 Shell 的名称（在命令行直接执行是）或者脚本名（在脚本中执行时）。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">echo</span> <span class="token variable">$0</span>
<span class="token function">bash</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面例子中，<code>$0</code>返回当前运行的是 Bash。</p> <h3 id="（6）"><a href="#（6）" class="header-anchor">#</a> （6）$-</h3> <p><code>$-</code>为当前 Shell 的启动参数。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">echo</span> $-
himBHs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="（7）-和"><a href="#（7）-和" class="header-anchor">#</a> （7）<code>$@</code>和<code>$#</code></h3> <p><code>$@</code>和<code>$#</code>表示脚本的参数数量，参见脚本一章。</p> <h2 id="_7-变量的默认值"><a href="#_7-变量的默认值" class="header-anchor">#</a> 7. 变量的默认值</h2> <p>Bash 提供四个特殊语法，跟变量的默认值有关，目的是保证变量不为空。</p> <h3 id="varname-word"><a href="#varname-word" class="header-anchor">#</a> ${varname:-word}</h3> <p>上面语法的含义是，如果变量varname存在且不为空，则返回它的值，否则返回word。它的目的是返回一个默认值，比如${count:-0}表示变量count不存在时返回0。</p> <h3 id="varname-word-2"><a href="#varname-word-2" class="header-anchor">#</a> ${varname:=word}</h3> <p>上面语法的含义是，如果变量varname存在且不为空，则返回它的值，否则将它设为word，并且返回word。它的目的是设置变量的默认值，比如${count:=0}表示变量count不存在时返回0，且将count设为0。</p> <h3 id="varname-word-3"><a href="#varname-word-3" class="header-anchor">#</a> ${varname:+word}</h3> <p>上面语法的含义是，如果变量名存在且不为空，则返回word，否则返回空值。它的目的是测试变量是否存在，比如${count:+1}表示变量count存在时返回1（表示true），否则返回空值。</p> <h3 id="varname-message"><a href="#varname-message" class="header-anchor">#</a> ${varname:?message}</h3> <p>上面语法的含义是，如果变量varname存在且不为空，则返回它的值，否则打印出varname: message，并中断脚本的执行。
如果省略了message，则输出默认的信息“parameter null or not set.”。
它的目的是防止变量未定义，比如<code>${count:?&quot;undefined!&quot;}</code>表示变量count未定义时就中断执行，抛出错误，返回给定的报错信息undefined!。</p> <p>上面四种语法如果用在脚本中，变量名的部分可以用到数字1到9，表示脚本的参数。</p> <p><code>filename=${1:?&quot;filename missing.&quot;}</code></p> <p>上面代码出现在脚本中，1表示脚本的第一个参数。如果该参数不存在，就退出脚本并报错。</p> <h2 id="_8-declare-命令"><a href="#_8-declare-命令" class="header-anchor">#</a> 8. declare 命令</h2> <p>declare命令可以声明一些特殊类型的变量，为变量设置一些限制，比如声明只读类型的变量和整数类型的变量。</p> <p>它的语法形式如下。</p> <p><code>declare OPTION VARIABLE=value</code></p> <p>declare命令的主要参数（OPTION）如下。</p> <ul><li><code>-a</code>：声明数组变量。</li> <li><code>-f</code>：输出所有函数定义。</li> <li><code>-F</code>：输出所有函数名。</li> <li><code>-i</code>：声明整数变量。</li> <li><code>-l</code>：声明变量为小写字母。</li> <li><code>-p</code>：查看变量信息。</li> <li><code>-r</code>：声明只读变量。</li> <li><code>-u</code>：声明变量为大写字母。</li> <li><code>-x</code>：该变量输出为环境变量。</li></ul> <p>declare命令如果用在函数中，声明的变量只在函数内部有效，等同于local命令。</p> <p>不带任何参数时，declare命令输出当前环境的所有变量，包括函数在内，等同于不带有任何参数的set命令。</p> <h3 id="（1）-i参数"><a href="#（1）-i参数" class="header-anchor">#</a> （1）-i参数</h3> <p>-i参数声明整数变量以后，可以直接进行数学运算。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">declare</span> -i <span class="token assign-left variable">val1</span><span class="token operator">=</span><span class="token number">12</span> <span class="token assign-left variable">val2</span><span class="token operator">=</span><span class="token number">5</span>
$ <span class="token builtin class-name">declare</span> -i result
$ <span class="token assign-left variable">result</span><span class="token operator">=</span>val1*val2
$ <span class="token builtin class-name">echo</span> <span class="token variable">$result</span>
<span class="token number">60</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面例子中，如果变量result不声明为整数，<code>val1*val2</code>会被当作字面量，不会进行整数运算。
另外，val1和val2其实不需要声明为整数，因为只要result声明为整数，它的赋值就会自动解释为整数运算。</p> <p>注意，一个变量声明为整数以后，依然可以被改写为字符串。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">declare</span> -i <span class="token assign-left variable">var</span><span class="token operator">=</span><span class="token number">12</span>
$ <span class="token assign-left variable">var</span><span class="token operator">=</span>foo
$ <span class="token builtin class-name">echo</span> <span class="token variable">$var</span>
<span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上面例子中，变量var声明为整数，覆盖以后，Bash 不会报错，但会赋以不确定的值，上面的例子中可能输出0，也可能输出的是3。</p> <h3 id="（2）-x参数"><a href="#（2）-x参数" class="header-anchor">#</a> （2）-x参数</h3> <p>-x参数等同于export命令，可以输出一个变量为子 Shell 的环境变量。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">declare</span> -x foo
<span class="token comment"># 等同于</span>
$ <span class="token builtin class-name">export</span> foo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="（3）-r参数"><a href="#（3）-r参数" class="header-anchor">#</a> （3）-r参数</h3> <p>-r参数可以声明只读变量，无法改变变量值，也不能unset变量。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">declare</span> -r <span class="token assign-left variable">bar</span><span class="token operator">=</span><span class="token number">1</span>

$ <span class="token assign-left variable">bar</span><span class="token operator">=</span><span class="token number">2</span>
bash: bar：只读变量
$ <span class="token builtin class-name">echo</span> <span class="token variable">$?</span>
<span class="token number">1</span>

$ <span class="token builtin class-name">unset</span> bar
bash: bar：只读变量
$ <span class="token builtin class-name">echo</span> <span class="token variable">$?</span>
<span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>上面例子中，后两个赋值语句都会报错，命令执行失败。</p> <h3 id="（4）-u参数"><a href="#（4）-u参数" class="header-anchor">#</a> （4）-u参数</h3> <p>-u参数声明变量为大写字母，可以自动把变量值转成大写字母。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">declare</span> -u foo
$ <span class="token assign-left variable">foo</span><span class="token operator">=</span>upper
$ <span class="token builtin class-name">echo</span> <span class="token variable">$foo</span>
UPPER
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="（5）-l参数"><a href="#（5）-l参数" class="header-anchor">#</a> （5）-l参数</h3> <p>-l参数声明变量为小写字母，可以自动把变量值转成小写字母。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">declare</span> -l bar
$ <span class="token assign-left variable">bar</span><span class="token operator">=</span>LOWER
$ <span class="token builtin class-name">echo</span> <span class="token variable">$bar</span>
lower
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="（6）-p参数"><a href="#（6）-p参数" class="header-anchor">#</a> （6）-p参数</h3> <p>-p参数输出变量信息。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token assign-left variable">foo</span><span class="token operator">=</span>hello
$ <span class="token builtin class-name">declare</span> -p foo
<span class="token builtin class-name">declare</span> -- <span class="token assign-left variable">foo</span><span class="token operator">=</span><span class="token string">&quot;hello&quot;</span>
$ <span class="token builtin class-name">declare</span> -p bar
bar：未找到
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面例子中，declare -p可以输出已定义变量的值，对于未定义的变量，会提示找不到。</p> <p>如果不提供变量名，declear -p输出所有变量的信息。</p> <p><code>$ declare -p</code></p> <h3 id="（7）-f参数"><a href="#（7）-f参数" class="header-anchor">#</a> （7）-f参数</h3> <p>-f参数输出当前环境的所有函数，包括它的定义。</p> <p><code>$ declare -f</code></p> <h3 id="（8）-f参数"><a href="#（8）-f参数" class="header-anchor">#</a> （8）-F参数</h3> <p>-F参数输出当前环境的所有函数名，不包含函数定义。</p> <p><code>$ declare -F</code></p> <h2 id="_9-readonly-命令"><a href="#_9-readonly-命令" class="header-anchor">#</a> 9. readonly 命令</h2> <p>readonly命令等同于declare -r，用来声明只读变量，不能改变变量值，也不能unset变量。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">readonly</span> <span class="token assign-left variable">foo</span><span class="token operator">=</span><span class="token number">1</span>
$ <span class="token assign-left variable">foo</span><span class="token operator">=</span><span class="token number">2</span>
bash: foo：只读变量
$ <span class="token builtin class-name">echo</span> <span class="token variable">$?</span>
<span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面例子中，更改只读变量foo会报错，命令执行失败。</p> <p>readonly命令有三个参数。</p> <ul><li><code>-f</code>：声明的变量为函数名。</li> <li><code>-p</code>：打印出所有的只读变量。</li> <li><code>-a</code>：声明的变量为数组。</li></ul> <h2 id="_10-let-命令"><a href="#_10-let-命令" class="header-anchor">#</a> 10. let 命令</h2> <p>let命令声明变量时，可以直接执行算术表达式。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">let</span> <span class="token assign-left variable">foo</span><span class="token operator">=</span><span class="token number">1</span>+2
$ <span class="token builtin class-name">echo</span> <span class="token variable">$foo</span>
<span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>上面例子中，let命令可以直接计算1 + 2。</p> <p>let命令的参数表达式如果包含空格，就需要使用引号。</p> <p><code>$ let &quot;foo = 1 + 2&quot;</code></p> <p>let可以同时对多个变量赋值，赋值表达式之间使用空格分隔。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">let</span> <span class="token string">&quot;v1 = 1&quot;</span> <span class="token string">&quot;v2 = v1++&quot;</span>
$ <span class="token builtin class-name">echo</span> <span class="token variable">$v1</span>,<span class="token variable">$v2</span>
<span class="token number">2,1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>上面例子中，let声明了两个变量v1和v2，其中v2等于v1++，表示先返回v1的值，然后v1自增。</p> <p>这种语法支持的运算符，参考《Bash 的算术运算》一章。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/24/2020, 1:39:57 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/source-files/shell/引号和转义.html" class="prev">
        引号和转义
      </a></span> <span class="next"><a href="/source-files/shell/字符串操作.html">
        字符串操作
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/source-files/assets/js/app.4b1e3a52.js" defer></script><script src="/source-files/assets/js/2.6ef31ef9.js" defer></script><script src="/source-files/assets/js/38.190c2d90.js" defer></script>
  </body>
</html>
