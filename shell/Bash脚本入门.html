<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>wums</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="wums note">
    <link rel="preload" href="/source-files/assets/css/0.styles.6eaab90e.css" as="style"><link rel="preload" href="/source-files/assets/js/app.932ba684.js" as="script"><link rel="preload" href="/source-files/assets/js/2.864a8ccc.js" as="script"><link rel="preload" href="/source-files/assets/js/31.ea353598.js" as="script"><link rel="prefetch" href="/source-files/assets/js/10.177dc8f2.js"><link rel="prefetch" href="/source-files/assets/js/11.b49554ae.js"><link rel="prefetch" href="/source-files/assets/js/12.25739623.js"><link rel="prefetch" href="/source-files/assets/js/13.60498d81.js"><link rel="prefetch" href="/source-files/assets/js/14.dcf3d1d5.js"><link rel="prefetch" href="/source-files/assets/js/15.81348f8e.js"><link rel="prefetch" href="/source-files/assets/js/16.d998eb05.js"><link rel="prefetch" href="/source-files/assets/js/17.a3402ec7.js"><link rel="prefetch" href="/source-files/assets/js/18.f9577047.js"><link rel="prefetch" href="/source-files/assets/js/19.62b43ab2.js"><link rel="prefetch" href="/source-files/assets/js/20.b4844afe.js"><link rel="prefetch" href="/source-files/assets/js/21.ecd68ae6.js"><link rel="prefetch" href="/source-files/assets/js/22.e9b5e086.js"><link rel="prefetch" href="/source-files/assets/js/23.9cc0bdb3.js"><link rel="prefetch" href="/source-files/assets/js/24.219d8a1c.js"><link rel="prefetch" href="/source-files/assets/js/25.bf193bd4.js"><link rel="prefetch" href="/source-files/assets/js/26.4959a6bc.js"><link rel="prefetch" href="/source-files/assets/js/27.42d8b10a.js"><link rel="prefetch" href="/source-files/assets/js/28.9c534434.js"><link rel="prefetch" href="/source-files/assets/js/29.84209916.js"><link rel="prefetch" href="/source-files/assets/js/3.63336ff8.js"><link rel="prefetch" href="/source-files/assets/js/30.8181689a.js"><link rel="prefetch" href="/source-files/assets/js/32.2142ef02.js"><link rel="prefetch" href="/source-files/assets/js/33.72c27819.js"><link rel="prefetch" href="/source-files/assets/js/34.eed7bde6.js"><link rel="prefetch" href="/source-files/assets/js/35.32e49eef.js"><link rel="prefetch" href="/source-files/assets/js/36.0a34f959.js"><link rel="prefetch" href="/source-files/assets/js/37.11835d1d.js"><link rel="prefetch" href="/source-files/assets/js/38.21f0ced6.js"><link rel="prefetch" href="/source-files/assets/js/39.97c3a6f9.js"><link rel="prefetch" href="/source-files/assets/js/4.993948f7.js"><link rel="prefetch" href="/source-files/assets/js/40.e12fd181.js"><link rel="prefetch" href="/source-files/assets/js/41.836b0965.js"><link rel="prefetch" href="/source-files/assets/js/42.0b9f63ac.js"><link rel="prefetch" href="/source-files/assets/js/43.3967c5db.js"><link rel="prefetch" href="/source-files/assets/js/44.46997924.js"><link rel="prefetch" href="/source-files/assets/js/45.bed7fecb.js"><link rel="prefetch" href="/source-files/assets/js/46.84be742d.js"><link rel="prefetch" href="/source-files/assets/js/47.b37026a0.js"><link rel="prefetch" href="/source-files/assets/js/48.5084ea6a.js"><link rel="prefetch" href="/source-files/assets/js/49.1572b7e6.js"><link rel="prefetch" href="/source-files/assets/js/5.5513e52c.js"><link rel="prefetch" href="/source-files/assets/js/50.d3fe02d2.js"><link rel="prefetch" href="/source-files/assets/js/51.16d177f1.js"><link rel="prefetch" href="/source-files/assets/js/52.661d02cf.js"><link rel="prefetch" href="/source-files/assets/js/53.a49e87b4.js"><link rel="prefetch" href="/source-files/assets/js/54.fa1ab498.js"><link rel="prefetch" href="/source-files/assets/js/55.8e717bd0.js"><link rel="prefetch" href="/source-files/assets/js/56.9b054675.js"><link rel="prefetch" href="/source-files/assets/js/57.43955e9a.js"><link rel="prefetch" href="/source-files/assets/js/58.816553c9.js"><link rel="prefetch" href="/source-files/assets/js/59.9e76dd5e.js"><link rel="prefetch" href="/source-files/assets/js/6.50f234c8.js"><link rel="prefetch" href="/source-files/assets/js/60.9be6ce66.js"><link rel="prefetch" href="/source-files/assets/js/61.17dd7e15.js"><link rel="prefetch" href="/source-files/assets/js/62.c92e1cbc.js"><link rel="prefetch" href="/source-files/assets/js/63.d8ab5d97.js"><link rel="prefetch" href="/source-files/assets/js/64.925eb8fa.js"><link rel="prefetch" href="/source-files/assets/js/65.9d02cf93.js"><link rel="prefetch" href="/source-files/assets/js/7.3fb738b2.js"><link rel="prefetch" href="/source-files/assets/js/8.a95c868f.js"><link rel="prefetch" href="/source-files/assets/js/9.9c55b760.js">
    <link rel="stylesheet" href="/source-files/assets/css/0.styles.6eaab90e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/source-files/" class="home-link router-link-active"><!----> <span class="site-name">wums</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/source-files/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://gitee.com/wmsnote/dashboard/wikis" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WiKi
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://gitee.com/wmsnote/source-files" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitEE
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/source-files/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://gitee.com/wmsnote/dashboard/wikis" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WiKi
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://gitee.com/wmsnote/source-files" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitEE
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/shell/" class="sidebar-heading clickable router-link-active open"><span>shell</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/source-files/shell/Bash简介.html" class="sidebar-link">Bash简介</a></li><li><a href="/source-files/shell/基本语法.html" class="sidebar-link">基本语法</a></li><li><a href="/source-files/shell/Bash的模式扩展.html" class="sidebar-link">Bash的模式扩展</a></li><li><a href="/source-files/shell/引号和转义.html" class="sidebar-link">引号和转义</a></li><li><a href="/source-files/shell/变量.html" class="sidebar-link">变量</a></li><li><a href="/source-files/shell/字符串操作.html" class="sidebar-link">字符串操作</a></li><li><a href="/source-files/shell/算数运算.html" class="sidebar-link">算数运算</a></li><li><a href="/source-files/shell/Bash行操作.html" class="sidebar-link">Bash行操作</a></li><li><a href="/source-files/shell/目录堆栈.html" class="sidebar-link">目录堆栈</a></li><li><a href="/source-files/shell/Bash脚本入门.html" class="active sidebar-link">Bash脚本入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/source-files/shell/Bash脚本入门.html#_1-shebang-行" class="sidebar-link">1. Shebang 行</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/Bash脚本入门.html#_2-执行权限和路径" class="sidebar-link">2. 执行权限和路径</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/Bash脚本入门.html#_3-env-命令" class="sidebar-link">3. env 命令</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/Bash脚本入门.html#_4-注释" class="sidebar-link">4. 注释</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/Bash脚本入门.html#_5-脚本参数" class="sidebar-link">5. 脚本参数</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/Bash脚本入门.html#_6-shift-命令" class="sidebar-link">6. shift 命令</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/Bash脚本入门.html#_7-getopts-命令" class="sidebar-link">7. getopts 命令</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/Bash脚本入门.html#_8-配置项参数终止符" class="sidebar-link">8. 配置项参数终止符 --</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/Bash脚本入门.html#_9-exit-命令" class="sidebar-link">9. exit 命令</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/Bash脚本入门.html#_10-命令执行结果" class="sidebar-link">10. 命令执行结果</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/Bash脚本入门.html#_11-source-命令" class="sidebar-link">11. source 命令</a></li><li class="sidebar-sub-header"><a href="/source-files/shell/Bash脚本入门.html#_12-别名，alias-命令" class="sidebar-link">12. 别名，alias 命令</a></li></ul></li><li><a href="/source-files/shell/read命令.html" class="sidebar-link">read命令</a></li><li><a href="/source-files/shell/条件判断.html" class="sidebar-link">条件判断</a></li><li><a href="/source-files/shell/循环.html" class="sidebar-link">循环</a></li><li><a href="/source-files/shell/函数.html" class="sidebar-link">函数</a></li><li><a href="/source-files/shell/数组.html" class="sidebar-link">数组</a></li><li><a href="/source-files/shell/set.html" class="sidebar-link">set命令</a></li><li><a href="/source-files/shell/脚本除错.html" class="sidebar-link">脚本除错</a></li><li><a href="/source-files/shell/mktemp_and_trap.html" class="sidebar-link">mktemp命令和trap命令</a></li><li><a href="/source-files/shell/Bash启动环境.html" class="sidebar-link">Bash启动环境</a></li><li><a href="/source-files/shell/命令提示符.html" class="sidebar-link">命令提示符</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/设计模式/" class="sidebar-heading clickable"><span>设计模式</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/prometheus/" class="sidebar-heading clickable"><span>prometheus</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/travis-ci/" class="sidebar-heading clickable"><span>travis-ci教程</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/Dockerfile/" class="sidebar-heading clickable"><span>Dockerfile</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/java/" class="sidebar-heading clickable"><span>Java教程</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/springboot2/" class="sidebar-heading clickable"><span>SpringBoot2.x</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/nginx/" class="sidebar-heading clickable"><span>nginx</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>脚本（script）就是包含一系列命令的一个文本文件。Shell 读取这个文件，依次执行里面的所有命令，就好像这些命令直接输入到命令行一样。
所有能够在命令行完成的任务，都能够用脚本完成。</p> <p>脚本的好处是可以重复使用，也可以指定在特定场合自动调用，比如系统启动或关闭时自动执行脚本。</p> <h2 id="_1-shebang-行"><a href="#_1-shebang-行" class="header-anchor">#</a> 1. Shebang 行</h2> <p>脚本的第一行通常是指定解释器，即这个脚本必须通过什么解释器执行。这一行以#!字符开头，这个字符称为 Shebang，所以这一行就叫做 Shebang 行。</p> <p><code>#!</code>后面就是脚本解释器的位置，Bash 脚本的解释器一般是<code>/bin/sh</code>或<code>/bin/bash</code>。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>
<span class="token comment"># 或者</span>
<span class="token comment">#!/bin/bash</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p><code>#!</code>与脚本解释器之间有没有空格，都是可以的。</p></blockquote> <p>如果 Bash 解释器不放在目录/bin，脚本就无法执行了。为了保险，可以写成下面这样。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/usr/bin/env bash</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面命令使用env命令（这个命令总是在/usr/bin目录），返回 Bash 可执行文件的位置。env命令的详细介绍，请看后文。</p> <p>Shebang 行不是必需的，但是建议加上这行。如果缺少该行，就需要手动将脚本传给解释器。举例来说，脚本是script.sh，有 Shebang 行的时候，可以直接调用执行。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ ./script.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面例子中，script.sh是脚本文件名。脚本通常使用.sh后缀名，不过这不是必需的。</p> <p>如果没有 Shebang 行，就只能手动将脚本传给解释器来执行。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ /bin/sh ./script.sh
<span class="token comment"># 或者</span>
$ <span class="token function">bash</span> ./script.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_2-执行权限和路径"><a href="#_2-执行权限和路径" class="header-anchor">#</a> 2. 执行权限和路径</h2> <p>前面说过，只要指定了 Shebang 行的脚本，可以直接执行。这有一个前提条件，就是脚本需要有执行权限。可以使用下面的命令，赋予脚本执行权限。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 给所有用户执行权限</span>
$ <span class="token function">chmod</span> +x script.sh

<span class="token comment"># 给所有用户读权限和执行权限</span>
$ <span class="token function">chmod</span> +rx script.sh
<span class="token comment"># 或者</span>
$ <span class="token function">chmod</span> <span class="token number">755</span> script.sh

<span class="token comment"># 只给脚本拥有者读权限和执行权限</span>
$ <span class="token function">chmod</span> u+rx script.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>脚本的权限通常设为755（拥有者有所有权限，其他人有读和执行权限）或者700（只有拥有者可以执行）。</p> <p>除了执行权限，脚本调用时，一般需要指定脚本的路径（比如path/script.sh）。如果将脚本放在环境变量$PATH指定的目录中，就不需要指定路径了。因为 Bash 会自动到这些目录中，寻找是否存在同名的可执行文件。</p> <blockquote><p>建议在主目录新建一个<code>~/bin</code>子目录，专门存放可执行脚本，然后把<code>~/bin</code>加入$PATH。</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span>:~/bin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面命令改变环境变量$PATH，将~/bin添加到$PATH的末尾。可以将这一行加到~/.bashrc文件里面，然后重新加载一次.bashrc，这个配置就可以生效了。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">source</span> ~/.bashrc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>以后不管在什么目录，直接输入脚本文件名，脚本就会执行。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ script.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面命令没有指定脚本路径，因为script.sh在$PATH指定的目录中。</p> <h2 id="_3-env-命令"><a href="#_3-env-命令" class="header-anchor">#</a> 3. env 命令</h2> <p><code>env</code>命令总是指向<code>/usr/bin/env</code>文件，或者说，这个二进制文件总是在目录<code>/usr/bin</code>。</p> <p><code>#!/usr/bin/env NAME</code> 这个语法的意思是，让 Shell 查找<code>$PATH</code>环境变量里面第一个匹配的NAME。
如果你不知道某个命令的具体路径，或者希望兼容其他用户的机器，这样的写法就很有用。</p> <p><code>/usr/bin/env bash</code> 的意思就是，返回bash可执行文件的位置，前提是bash的路径是在$PATH里面。其他脚本文件也可以使用这个命令。比如 Node.js 脚本的 Shebang 行，可以写成下面这样。</p> <div class="language-Bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/usr/bin/env node</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>env命令的参数如下。</p> <p>-i, --ignore-environment：不带环境变量启动。
-u, --unset=NAME：从环境变量中删除一个变量。
--help：显示帮助。
--version：输出版本信息。</p> <p>下面是一个例子，新建一个不带任何环境变量的 Shell。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">env</span> -i /bin/sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_4-注释"><a href="#_4-注释" class="header-anchor">#</a> 4. 注释</h2> <p>Bash 脚本中，#表示注释，可以放在行首，也可以放在行尾。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>
<span class="token comment"># 本行是注释</span>
<span class="token builtin class-name">echo</span> <span class="token string">'Hello World!'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'Hello World!'</span> <span class="token comment"># 井号后面的部分也是注释</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>建议在脚本开头，使用注释说明当前脚本的作用，这样有利于日后的维护。</p> <h2 id="_5-脚本参数"><a href="#_5-脚本参数" class="header-anchor">#</a> 5. 脚本参数</h2> <p>调用脚本的时候，脚本文件名后面可以带有参数。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ script.sh word1 word2 word3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面例子中，script.sh是一个脚本文件，word1、word2和word3是三个参数。</p> <p>脚本文件内部，可以使用特殊变量，引用这些参数。</p> <table><thead><tr><th>变量</th> <th>含义</th></tr></thead> <tbody><tr><td>$0</td> <td>脚本文件名，即script.sh。</td></tr> <tr><td>$1~$9</td> <td>对应脚本的第一个参数到第九个参数。</td></tr> <tr><td>$#</td> <td>参数的总数。</td></tr> <tr><td>$@</td> <td>全部的参数，参数之间使用空格分隔。</td></tr> <tr><td>$*</td> <td>全部的参数，参数之间使用变量$IFS值的第一个字符分隔，默认为空格，但是可以自定义。</td></tr></tbody></table> <blockquote><p>如果脚本的参数多于9个，那么第10个参数可以用${10}的形式引用，以此类推。
注意，如果命令是command -o foo bar，那么-o是$1，foo是$2，bar是$3。</p></blockquote> <p>下面是一个脚本内部读取命令行参数的例子。</p> <div class="language-Bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># script.sh</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;全部参数：&quot;</span> <span class="token variable">$@</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;命令行参数数量：&quot;</span> <span class="token variable">$#</span>
<span class="token builtin class-name">echo</span> <span class="token string">'<span class="token variable">$0</span> = '</span> <span class="token variable">$0</span>
<span class="token builtin class-name">echo</span> <span class="token string">'<span class="token variable">$1</span> = '</span> <span class="token variable">$1</span>
<span class="token builtin class-name">echo</span> <span class="token string">'<span class="token variable">$2</span> = '</span> <span class="token variable">$2</span>
<span class="token builtin class-name">echo</span> <span class="token string">'<span class="token variable">$3</span> = '</span> <span class="token variable">$3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>执行结果如下。</p> <p><code>$ ./script.sh a b c</code></p> <p>全部参数：a b c
命令行参数数量：3
$0 =  script.sh
$1 =  a
$2 =  b
$3 =  c</p> <p>用户可以输入任意数量的参数，利用for循环，可以读取每一个参数。</p> <div class="language-Bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token builtin class-name">echo</span> <span class="token variable">$i</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面例子中，<code>$@</code> 返回一个全部参数的列表，然后使用for循环遍历。</p> <p>如果多个参数放在双引号里面，视为一个参数。</p> <p><code>$ ./script.sh &quot;a b&quot;</code></p> <p>上面例子中，Bash 会认为&quot;a b&quot;是一个参数，$1会返回a b。注意，返回时不包括双引号。</p> <h2 id="_6-shift-命令"><a href="#_6-shift-命令" class="header-anchor">#</a> 6. shift 命令</h2> <p>shift命令可以改变脚本参数，每次执行都会移除脚本当前的第一个参数（$1），使得后面的参数向前一位，即$2变成$1、$3变成$2、$4变成$3，以此类推。</p> <p>while循环结合shift命令，也可以读取每一个参数。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;一共输入了 <span class="token variable">$#</span> 个参数&quot;</span>

<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;剩下 <span class="token variable">$#</span> 个参数&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;参数：<span class="token variable">$1</span>&quot;</span>
  <span class="token builtin class-name">shift</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>上面例子中，shift命令每次移除当前第一个参数，从而通过while循环遍历所有参数。</p> <p>shift命令可以接受一个整数作为参数，指定所要移除的参数个数，默认为1。</p> <p><code>shift 3</code>: 上面的命令移除前三个参数，原来的$4变成$1。</p> <h2 id="_7-getopts-命令"><a href="#_7-getopts-命令" class="header-anchor">#</a> 7. getopts 命令</h2> <p>getopts命令用在脚本内部，可以解析复杂的脚本命令行参数，通常与while循环一起使用，取出脚本所有的带有前置连词线（-）的参数。</p> <p><code>getopts optstring name</code></p> <p>它带有两个参数。第一个参数optstring是字符串，给出脚本所有的连词线参数。比如，某个脚本可以有三个配置项参数-l、-h、-a，其中只有-a可以带有参数值，而-l和-h是开关参数，那么getopts的第一个参数写成<code>lha:</code>，顺序不重要。注意，a后面有一个冒号，表示该参数带有参数值，getopts规定带有参数值的配置项参数，后面必须带有一个冒号（:）。getopts的第二个参数name是一个变量名，用来保存当前取到的配置项参数，即l、h或a。</p> <p>下面是一个例子。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token keyword">while</span> <span class="token builtin class-name">getopts</span> <span class="token string">'lha:'</span> OPTION<span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$OPTION</span>&quot;</span> <span class="token keyword">in</span>
    l<span class="token punctuation">)</span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;linuxconfig&quot;</span>
      <span class="token punctuation">;</span><span class="token punctuation">;</span>

    h<span class="token punctuation">)</span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;h stands for h&quot;</span>
      <span class="token punctuation">;</span><span class="token punctuation">;</span>

    a<span class="token punctuation">)</span>
      <span class="token assign-left variable">avalue</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$OPTARG</span>&quot;</span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;The value provided is <span class="token variable">$OPTARG</span>&quot;</span>
      <span class="token punctuation">;</span><span class="token punctuation">;</span>
    ?<span class="token punctuation">)</span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;script usage: <span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> $0<span class="token variable">)</span></span> [-l] [-h] [-a somevalue]&quot;</span> <span class="token operator">&gt;</span><span class="token file-descriptor important">&amp;2</span>
      <span class="token builtin class-name">exit</span> <span class="token number">1</span>
      <span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token keyword">esac</span>
<span class="token keyword">done</span>
<span class="token builtin class-name">shift</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$((</span>$OPTIND <span class="token operator">-</span> <span class="token number">1</span><span class="token variable">))</span></span>&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>上面例子中，while循环不断执行<code>getopts 'lha:' OPTION</code>命令，每次执行就会读取一个连词线参数（以及对应的参数值），然后进入循环体。变量OPTION保存的是，当前处理的那一个连词线参数（即l、h或a）。如果用户输入了没有指定的参数（比如-x），那么OPTION等于?。循环体内使用case判断，处理这四种不同的情况。</p> <p>如果某个连词线参数带有参数值，比如<code>-a foo</code>，那么处理a参数的时候，环境变量<code>$OPTARG</code>保存的就是参数值。</p> <p>注意，只要遇到不带连词线的参数，getopts就会执行失败，从而退出while循环。比如，getopts可以解析command -l foo，但不可以解析command foo -l。另外，多个连词线参数写在一起的形式，比如command -lh，getopts也可以正确处理。</p> <p>变量$OPTIND在getopts开始执行前是1，然后每次执行就会加1。等到退出while循环，就意味着连词线参数全部处理完毕。
这时，<code>$OPTIND - 1</code>就是已经处理的连词线参数个数，使用shift命令将这些参数移除，
保证后面的代码可以用$1、$2等处理命令的主参数。</p> <h2 id="_8-配置项参数终止符"><a href="#_8-配置项参数终止符" class="header-anchor">#</a> 8. 配置项参数终止符 --</h2> <p>变量当作命令的参数时，有时希望指定变量只能作为实体参数，不能当作配置项参数，这时可以使用配置项参数终止符--。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token assign-left variable">myPath</span><span class="token operator">=</span><span class="token string">&quot;~/docs&quot;</span>
$ <span class="token function">ls</span> -- <span class="token variable">$myPath</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面例子中，--强制变量$myPath只能当作实体参数（即路径名）解释。</p> <p>如果变量不是路径名，就会报错。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token assign-left variable">myPath</span><span class="token operator">=</span><span class="token string">&quot;-l&quot;</span>
$ <span class="token function">ls</span> -- <span class="token variable">$myPath</span>
ls: 无法访问<span class="token string">'-l'</span><span class="token builtin class-name">:</span> 没有那个文件或目录
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>上面例子中，变量myPath的值为-l，不是路径。但是，--强制$myPath只能作为路径解释，导致报错“不存在该路径”。</p> <h2 id="_9-exit-命令"><a href="#_9-exit-命令" class="header-anchor">#</a> 9. exit 命令</h2> <p>exit命令用于终止当前脚本的执行，并向 Shell 返回一个退出值。</p> <p><code>$ exit</code>: 上面命令中止当前脚本，将最后一条命令的退出状态，作为整个脚本的退出状态。</p> <p>exit命令后面可以跟参数，该参数就是退出状态。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 退出值为0（成功）</span>
$ <span class="token builtin class-name">exit</span> <span class="token number">0</span>

<span class="token comment"># 退出值为1（失败）</span>
$ <span class="token builtin class-name">exit</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>退出时，脚本会返回一个退出值。脚本的退出值，0表示正常，1表示发生错误，2表示用法不对，126表示不是可执行脚本，127表示命令没有发现。如果脚本被信号N终止，则退出值为128 + N。简单来说，只要退出值非0，就认为执行出错。</p> <p>下面是一个例子。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -u<span class="token variable">)</span></span> <span class="token operator">!=</span> <span class="token string">&quot;0&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;根用户才能执行当前脚本&quot;</span>
  <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上面的例子中，<code>id -u</code> 命令返回用户的 ID，一旦用户的 ID 不等于0（根用户的 ID），脚本就会退出，并且退出码为1，表示运行失败。</p> <p>exit与return命令的差别是，return命令是函数的退出，并返回一个值给调用者，脚本依然执行。exit是整个脚本的退出，如果在函数之中调用exit，则退出函数，并终止脚本执行。</p> <h2 id="_10-命令执行结果"><a href="#_10-命令执行结果" class="header-anchor">#</a> 10. 命令执行结果</h2> <p>命令执行结束后，会有一个返回值。0表示执行成功，非0（通常是1）表示执行失败。环境变量<code>$?</code>可以读取前一个命令的返回值。</p> <p>利用这一点，可以在脚本中对命令执行结果进行判断。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token variable">$some_directory</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$?</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token function">rm</span> *
<span class="token keyword">else</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;无法切换目录！&quot;</span> <span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span><span class="token file-descriptor important">&amp;2</span>
  <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>cd $some_directory</code> 这个命令如果执行成功（返回值等于0），就删除该目录里面的文件，否则退出脚本，整个脚本的返回值变为1，表示执行失败。</p> <p>由于if可以直接判断命令的执行结果，执行相应的操作，上面的脚本可以改写成下面的样子。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token keyword">if</span> <span class="token builtin class-name">cd</span> <span class="token variable">$some_directory</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token function">rm</span> *
<span class="token keyword">else</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;Could not change directory! Aborting.&quot;</span> <span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span><span class="token file-descriptor important">&amp;2</span>
  <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>更简洁的写法是利用两个逻辑运算符<code>&amp;&amp;</code>（且）和<code>||</code>（或）。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 第一步执行成功，才会执行第二步</span>
<span class="token builtin class-name">cd</span> <span class="token variable">$some_directory</span> <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> *

<span class="token comment"># 第一步执行失败，才会执行第二步</span>
<span class="token builtin class-name">cd</span> <span class="token variable">$some_directory</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_11-source-命令"><a href="#_11-source-命令" class="header-anchor">#</a> 11. source 命令</h2> <p>source命令用于执行一个脚本，通常用于重新加载一个配置文件。</p> <p><code>$ source .bashrc</code></p> <p>source命令最大的特点是在当前 Shell 执行脚本，不像直接执行脚本时，会新建一个子 Shell。所以，source命令执行脚本时，不需要export变量。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># test.sh</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$foo</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>上面脚本输出$foo变量的值。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 当前 Shell 新建一个变量 foo</span>
$ <span class="token assign-left variable">foo</span><span class="token operator">=</span><span class="token number">1</span>

<span class="token comment"># 打印输出 1</span>
$ <span class="token builtin class-name">source</span> test.sh
<span class="token number">1</span>

<span class="token comment"># 打印输出空字符串</span>
$ <span class="token function">bash</span> test.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>上面例子中，当前 Shell 的变量foo并没有export，所以直接执行无法读取，但是source执行可以读取。</p> <p>source命令的另一个用途，是在脚本内部加载外部库。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token builtin class-name">source</span> ./lib.sh

function_from_lib
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面脚本在内部使用source命令加载了一个外部库，然后就可以在脚本里面，使用这个外部库定义的函数。</p> <p>source有一个简写形式，可以使用一个点（.）来表示。</p> <p><code>$ . .bashrc</code></p> <h2 id="_12-别名，alias-命令"><a href="#_12-别名，alias-命令" class="header-anchor">#</a> 12. 别名，alias 命令</h2> <p>alias命令用来为一个命令指定别名，这样更便于记忆。下面是alias的格式。</p> <p><code>alias NAME=DEFINITION</code></p> <p>上面命令中，NAME是别名的名称，DEFINITION是别名对应的原始命令。注意，等号两侧不能有空格，否则会报错。</p> <p>一个常见的例子是为grep命令起一个search的别名。</p> <p><code>alias search=grep</code>
alias也可以用来为长命令指定一个更短的别名。下面是通过别名定义一个today的命令。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">alias</span> <span class="token assign-left variable">today</span><span class="token operator">=</span><span class="token string">'date +&quot;%A, %B %-d, %Y&quot;'</span>
$ today

星期一, 一月 <span class="token number">6</span>, <span class="token number">2020</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>有时为了防止误删除文件，可以指定rm命令的别名。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">alias</span> <span class="token assign-left variable">rm</span><span class="token operator">=</span><span class="token string">'rm -i'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面命令指定rm命令是<code>rm -i</code>，每次删除文件之前，都会让用户确认。</p> <p>alias定义的别名也可以接受参数，参数会直接传入原始命令。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">alias</span> <span class="token assign-left variable">echo</span><span class="token operator">=</span><span class="token string">'echo It says: '</span>
$ <span class="token builtin class-name">echo</span> hello world
It says: hello world
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>上面例子中，别名定义了echo命令的前两个参数，等同于修改了echo命令的默认行为。</p> <p>指定别名以后，就可以像使用其他命令一样使用别名。一般来说，都会把常用的别名写在<code>~/.bashrc</code>的末尾。
另外，只能为命令定义别名，为其他部分（比如很长的路径）定义别名是无效的。</p> <p>直接调用alias命令，可以显示所有别名。</p> <p><code>$ alias</code></p> <p>unalias命令可以解除别名。</p> <p><code>$ unalias lt</code></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/26/2020, 2:03:54 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/source-files/shell/目录堆栈.html" class="prev">
        目录堆栈
      </a></span> <span class="next"><a href="/source-files/shell/read命令.html">
        read命令
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/source-files/assets/js/app.932ba684.js" defer></script><script src="/source-files/assets/js/2.864a8ccc.js" defer></script><script src="/source-files/assets/js/31.ea353598.js" defer></script>
  </body>
</html>
