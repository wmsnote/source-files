<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>wums</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="wums note">
    <link rel="preload" href="/source-files/assets/css/0.styles.65bc254d.css" as="style"><link rel="preload" href="/source-files/assets/js/app.0b8b2e65.js" as="script"><link rel="preload" href="/source-files/assets/js/2.6ef31ef9.js" as="script"><link rel="preload" href="/source-files/assets/js/13.8532f00c.js" as="script"><link rel="prefetch" href="/source-files/assets/js/10.c68d946e.js"><link rel="prefetch" href="/source-files/assets/js/11.79dea162.js"><link rel="prefetch" href="/source-files/assets/js/12.689d4069.js"><link rel="prefetch" href="/source-files/assets/js/14.b7cded15.js"><link rel="prefetch" href="/source-files/assets/js/15.09cf260c.js"><link rel="prefetch" href="/source-files/assets/js/16.35b132c8.js"><link rel="prefetch" href="/source-files/assets/js/17.719b4edd.js"><link rel="prefetch" href="/source-files/assets/js/18.eb6fe472.js"><link rel="prefetch" href="/source-files/assets/js/19.d37635ab.js"><link rel="prefetch" href="/source-files/assets/js/20.e1afb37d.js"><link rel="prefetch" href="/source-files/assets/js/21.2b1af9d0.js"><link rel="prefetch" href="/source-files/assets/js/22.5ce7fe0f.js"><link rel="prefetch" href="/source-files/assets/js/23.d80003fd.js"><link rel="prefetch" href="/source-files/assets/js/24.66e7de86.js"><link rel="prefetch" href="/source-files/assets/js/25.1a940d3c.js"><link rel="prefetch" href="/source-files/assets/js/26.7825c393.js"><link rel="prefetch" href="/source-files/assets/js/27.b6918556.js"><link rel="prefetch" href="/source-files/assets/js/28.08a4b9f9.js"><link rel="prefetch" href="/source-files/assets/js/29.9ac320dc.js"><link rel="prefetch" href="/source-files/assets/js/3.4ad0ba7e.js"><link rel="prefetch" href="/source-files/assets/js/30.9fb876bc.js"><link rel="prefetch" href="/source-files/assets/js/31.13c776a6.js"><link rel="prefetch" href="/source-files/assets/js/32.113c014a.js"><link rel="prefetch" href="/source-files/assets/js/33.4682f3cf.js"><link rel="prefetch" href="/source-files/assets/js/34.cf119ae3.js"><link rel="prefetch" href="/source-files/assets/js/4.d76f0767.js"><link rel="prefetch" href="/source-files/assets/js/5.17e27241.js"><link rel="prefetch" href="/source-files/assets/js/6.ea86a040.js"><link rel="prefetch" href="/source-files/assets/js/7.e5cd0322.js"><link rel="prefetch" href="/source-files/assets/js/8.bef3d365.js"><link rel="prefetch" href="/source-files/assets/js/9.c02c9d17.js">
    <link rel="stylesheet" href="/source-files/assets/css/0.styles.65bc254d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/source-files/" class="home-link router-link-active"><!----> <span class="site-name">wums</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/source-files/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://gitee.com/wmsnote/dashboard/wikis" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WiKi
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://gitee.com/wmsnote/source-files" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitEE
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/source-files/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://gitee.com/wmsnote/dashboard/wikis" target="_blank" rel="noopener noreferrer" class="nav-link external">
  WiKi
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://gitee.com/wmsnote/source-files" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitEE
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/shell/" class="sidebar-heading clickable router-link-active open"><span>shell</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/source-files/shell/Bash简介.html" class="sidebar-link">Bash简介</a></li><li><a href="/source-files/shell/基本语法.html" class="sidebar-link">基本语法</a></li><li><a href="/source-files/shell/Bash的模式扩展.html" class="active sidebar-link">Bash的模式扩展</a></li><li><a href="/source-files/shell/条件判断.html" class="sidebar-link">条件判断</a></li><li><a href="/source-files/shell/循环.html" class="sidebar-link">循环</a></li><li><a href="/source-files/shell/函数.html" class="sidebar-link">函数</a></li><li><a href="/source-files/shell/set.html" class="sidebar-link">set命令</a></li><li><a href="/source-files/shell/脚本除错.html" class="sidebar-link">脚本除错</a></li><li><a href="/source-files/shell/mktemp_and_trap.html" class="sidebar-link">mktemp命令和trap命令</a></li><li><a href="/source-files/shell/Bash启动环境.html" class="sidebar-link">Bash启动环境</a></li><li><a href="/source-files/shell/命令提示符.html" class="sidebar-link">命令提示符</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/设计模式/" class="sidebar-heading clickable"><span>设计模式</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/prometheus/" class="sidebar-heading clickable"><span>prometheus</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/travis-ci/" class="sidebar-heading clickable"><span>travis-ci教程</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/source-files/Dockerfile/" class="sidebar-heading clickable"><span>Dockerfile</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>wangdoc.com /bash/expansion.html
Bash 的模式扩展
8-10 minutes
网道（WangDoc.com），互联网文档计划</p> <p>简介 #
Shell 接收到用户输入的命令以后，会根据空格将用户的输入，拆分成一个个词元（token）。然后，Shell 会扩展词元里面的特殊字符，扩展完成后才会调用相应的命令。</p> <p>这种特殊字符的扩展，称为模式扩展（globbing）。其中有些用到通配符，又称为通配符扩展（wildcard expansion）。Bash 一共提供八种扩展。</p> <p>波浪线扩展
? 字符扩展</p> <ul><li>字符扩展
方括号扩展
大括号扩展
变量扩展
子命令扩展
算术扩展
本章介绍这八种扩展。</li></ul> <p>Bash 是先进行扩展，再执行命令。因此，扩展的结果是由 Bash 负责的，与所要执行的命令无关。命令本身并不存在参数扩展，收到什么参数就原样执行。这一点务必需要记住。</p> <p>globbing这个词，来自于早期的 Unix 系统有一个/etc/glob文件，保存扩展的模板。后来 Bash 内置了这个功能，但是这个名字就保留了下来。</p> <p>模式扩展与正则表达式的关系是，模式扩展早于正则表达式出现，可以看作是原始的正则表达式。它的功能没有正则那么强大灵活，但是优点是简单和方便。</p> <p>Bash 允许用户关闭扩展。</p> <p>$ set -o noglob</p> <p>$ set -f
下面的命令可以重新打开扩展。</p> <p>$ set +o noglob</p> <p>$ set +f
波浪线扩展 #
波浪线~会自动扩展成当前用户的主目录。</p> <p>$ echo ~
/home/me
~/dir表示扩展成主目录的某个子目录，dir是主目录里面的一个子目录名。</p> <p>$ cd ~/foo
~user表示扩展成用户user的主目录。</p> <p>$ echo ~foo
/home/foo</p> <p>$ echo ~root
/root
上面例子中，Bash 会根据波浪号后面的用户名，返回该用户的主目录。</p> <p>如果~user的user是不存在的用户名，则波浪号扩展不起作用。</p> <p>$ echo ~nonExistedUser
~nonExistedUser
~+会扩展成当前所在的目录，等同于pwd命令。</p> <p>$ cd ~/foo
$ echo ~+
/home/me/foo
? 字符扩展 #
?字符代表文件路径里面的任意单个字符，不包括空字符。比如，Data???匹配所有Data后面跟着三个字符的文件名。</p> <p>$ ls ?.txt
a.txt b.txt
上面命令中，?表示单个字符，所以会同时匹配a.txt和b.txt。</p> <p>如果匹配多个字符，就需要多个?连用。</p> <p>$ ls ??.txt
ab.txt
上面命令中，??匹配了两个字符。</p> <p>? 字符扩展属于文件名扩展，只有文件确实存在的前提下，才会发生扩展。如果文件不存在，扩展就不会发生。</p> <p>$ echo ?.txt
a.txt</p> <p>$ echo ?.txt
?.txt
上面例子中，如果?.txt可以扩展成文件名，echo命令会输出扩展后的结果；如果不能扩展成文件名，echo就会原样输出?.txt。</p> <ul><li>字符扩展 #
*字符代表文件路径里面的任意数量的字符，包括零个字符。</li></ul> <p>$ ls *.txt
a.txt b.txt ab.txt</p> <p>$ ls *
下面是*匹配空字符的例子。</p> <p>$ ls a*.txt
a.txt ab.txt</p> <p>$ ls <em>b</em>
b.txt ab.txt
注意，*不会匹配隐藏文件（以.开头的文件）。</p> <p>$ echo .*</p> <p>$ echo .[!.]*
*字符扩展也属于文件名扩展，只有文件确实存在的前提下才会扩展。如果文件不存在，就会原样输出。</p> <p>$ echo c*.txt
c*.txt
上面例子中，当前目录里面没有c开头的文件，导致c*.txt会原样输出。</p> <p>*只匹配当前目录，不会匹配子目录。</p> <p>$ ls *.txt</p> <p>$ ls <em>/</em>.txt
上面的例子，文本文件在子目录，<em>.txt不会产生匹配，必须写成</em>/*.txt。有几层子目录，就必须写几层星号。</p> <p>Bash 4.0 引入了一个参数globstar，当该参数打开时，允许<strong>匹配零个或多个子目录。因此，</strong>/*.txt可以匹配顶层的文本文件和任意深度子目录的文本文件。详细介绍请看后面shopt命令的介绍。</p> <p>方括号扩展 #
方括号扩展的形式是[...]，只有文件确实存在的前提下才会扩展。如果文件不存在，就会原样输出。括号之中的任意一个字符。比如，[aeiou]可以匹配五个元音字母中的任意一个。</p> <p>$ ls [ab].txt
a.txt b.txt</p> <p>$ ls [ab].txt
a.txt
上面例子中，[ab]可以匹配a或b，前提是确实存在相应的文件。</p> <p>方括号扩展属于文件名匹配，即扩展后的结果必须符合现有的文件路径。如果不存在匹配，就会保持原样，不进行扩展。</p> <p>$ ls [ab].txt
ls: 无法访问'[ab].txt': 没有那个文件或目录
上面例子中，由于扩展后的文件不存在，[ab].txt就原样输出了，导致ls命名报错。</p> <p>方括号扩展还有两种变体：[^...]和[!...]。它们表示匹配不在方括号里面的字符，这两种写法是等价的。比如，[^abc]或[!abc]表示匹配除了a、b、c以外的字符。</p> <p>$ ls ?[!a]?
aba bbb
上面命令中，[!a]表示文件名第二个字符不是a的文件名，所以返回了aba和bbb两个文件。</p> <p>注意，如果需要匹配[字符，可以放在方括号内，比如[[aeiou]。如果需要匹配连字号-，只能放在方括号内部的开头或结尾，比如[-aeiou]或[aeiou-]。</p> <p>[start-end] 扩展 #
方括号扩展有一个简写形式[start-end]，表示匹配一个连续的范围。比如，[a-c]等同于[abc]，[0-9]匹配[0123456789]。</p> <p>$ ls [a-c].txt
a.txt
b.txt
c.txt</p> <p>$ ls report[0-9].txt
report1.txt
report2.txt
report3.txt
...
下面是一些常用简写的例子。</p> <p>[a-z]：所有小写字母。
[a-zA-Z]：所有小写字母与大写字母。
[a-zA-Z0-9]：所有小写字母、大写字母与数字。
[abc]*：所有以a、b、c字符之一开头的文件名。
program.[co]：文件program.c与文件program.o。
BACKUP.[0-9][0-9][0-9]：所有以BACKUP.开头，后面是三个数字的文件名。
这种简写形式有一个否定形式[!start-end]，表示匹配不属于这个范围的字符。比如，[!a-zA-Z]表示匹配非英文字母的字符。</p> <p>$ echo report[!1–3].txt
report4.txt report5.txt
上面代码中，[!1-3]表示排除1、2和3。</p> <p>大括号扩展 #
大括号扩展{...}表示分别扩展成大括号里面的所有值，各个值之间使用逗号分隔。比如，{1,2,3}扩展成1 2 3。</p> <p>$ echo {1,2,3}
1 2 3</p> <p>$ echo d{a,e,i,u,o}g
dag deg dig dug dog</p> <p>$ echo Front-{A,B,C}-Back
Front-A-Back Front-B-Back Front-C-Back
注意，大括号扩展不是文件名扩展。它会扩展成所有给定的值，而不管是否有对应的文件存在。</p> <p>$ ls {a,b,c}.txt
ls: 无法访问'a.txt': 没有那个文件或目录
ls: 无法访问'b.txt': 没有那个文件或目录
ls: 无法访问'c.txt': 没有那个文件或目录
上面例子中，即使不存在对应的文件，{a,b,c}依然扩展成三个文件名，导致ls命令报了三个错误。</p> <p>另一个需要注意的地方是，大括号内部的逗号前后不能有空格。否则，大括号扩展会失效。</p> <p>$ echo {1 , 2}
{1 , 2}
上面例子中，逗号前后有空格，Bash 就会认为这不是大括号扩展，而是三个独立的参数。</p> <p>逗号前面可以没有值，表示扩展的第一项为空。</p> <p>$ cp a.log{,.bak}</p> <p>大括号可以嵌套。</p> <p>$ echo {j{p,pe}g,png}
jpg jpeg png</p> <p>$ echo a{A{1,2},B{3,4}}b
aA1b aA2b aB3b aB4b
大括号也可以与其他模式联用，并且总是先于其他模式进行扩展。</p> <p>$ echo {cat,d*}
cat dawg dg dig dog doug dug
上面例子中，会先进行大括号扩展，然后进行*扩展。</p> <p>大括号可以用于多字符的模式，方括号不行（只能匹配单字符）。</p> <p>$ echo {cat,dog}
cat dog
由于大括号扩展{...}不是文件名扩展，所以它总是会扩展的。这与方括号扩展[...]完全不同，如果匹配的文件不存在，方括号就不会扩展。这一点要注意区分。</p> <p>$ echo [ab].txt
[ab].txt</p> <p>$ echo {a,b}.txt
a.txt b.txt
上面例子中，如果不存在a.txt和b.txt，那么[ab].txt就会变成一个普通的文件名，而{a,b}.txt可以照样扩展。</p> <p>{start..end} 扩展 #
大括号扩展有一个简写形式{start..end}，表示扩展成一个连续序列。比如，{a..z}可以扩展成26个小写英文字母。</p> <p>$ echo {a..c}
a b c</p> <p>$ echo d{a..d}g
dag dbg dcg ddg</p> <p>$ echo {1..4}
1 2 3 4</p> <p>$ echo Number_{1..5}
Number_1 Number_2 Number_3 Number_4 Number_5
这种简写形式支持逆序。</p> <p>$ echo {c..a}
c b a</p> <p>$ echo {5..1}
5 4 3 2 1
注意，如果遇到无法理解的简写，大括号模式就会原样输出，不会扩展。</p> <p>$ echo {a1..3c}
{a1..3c}
这种简写形式可以嵌套使用，形成复杂的扩展。</p> <p>$ echo .{mp{3..4},m4{a,b,p,v}}
.mp3 .mp4 .m4a .m4b .m4p .m4v
大括号扩展的常见用途为新建一系列目录。</p> <p>$ mkdir {2007..2009}-{01..12}
上面命令会新建36个子目录，每个子目录的名字都是”年份-月份“。</p> <p>这个写法的另一个常见用途，是直接用于for循环。</p> <p>for i in {1..4}
do
echo $i
done
上面例子会循环4次。</p> <p>如果整数前面有前导0，扩展输出的每一项都有前导0。</p> <p>$ echo {01..5}
01 02 03 04 05</p> <p>$ echo {001..5}
001 002 003 004 005
这种简写形式还可以使用第二个双点号（start..end..step），用来指定扩展的步长。</p> <p>$ echo {0..8..2}
0 2 4 6 8
上面代码将0扩展到8，每次递增的长度为2，所以一共输出5个数字。</p> <p>多个简写形式连用，会有循环处理的效果。</p> <p>$ echo {a..c}{1..3}
a1 a2 a3 b1 b2 b3 c1 c2 c3
变量扩展 #
Bash 将美元符号$开头的词元视为变量，将其扩展成变量值，详见《Bash 变量》一章。</p> <p>$ echo $SHELL
/bin/bash
变量名除了放在美元符号后面，也可以放在${}里面。</p> <p>$ echo ${SHELL}
/bin/bash
${!string*}或${!string@}返回所有匹配给定字符串string的变量名。</p> <p>$ echo ${!S*}
SECONDS SHELL SHELLOPTS SHLVL SSH_AGENT_PID SSH_AUTH_SOCK
上面例子中，${!S*}扩展成所有以S开头的变量名。</p> <p>子命令扩展 #
$(...)可以扩展成另一个命令的运行结果，该命令的所有输出都会作为返回值。</p> <p>$ echo $(date)
Tue Jan 28 00:01:13 CST 2020
上面例子中，$(date)返回date命令的运行结果。</p> <p>还有另一种较老的语法，子命令放在反引号之中，也可以扩展成命令的运行结果。</p> <p>$ echo <code>date</code>
Tue Jan 28 00:01:13 CST 2020
$(...)可以嵌套，比如$(ls $(pwd))。</p> <p>算术扩展 #
$((...))可以扩展成整数运算的结果，详见《Bash 的算术运算》一章。</p> <p>$ echo $((2 + 2))
4
字符类 #
[[:class:]]表示一个字符类，扩展成某一类特定字符之中的一个。常用的字符类如下。</p> <p>[[:alnum:]]：匹配任意英文字母与数字
[[:alpha:]]：匹配任意英文字母
[[:blank:]]：空格和 Tab 键。
[[:cntrl:]]：ASCII 码 0-31 的不可打印字符。
[[:digit:]]：匹配任意数字 0-9。
[[:graph:]]：A-Z、a-z、0-9 和标点符号。
[[:lower:]]：匹配任意小写字母 a-z。
[[:print:]]：ASCII 码 32-127 的可打印字符。
[[:punct:]]：标点符号（除了 A-Z、a-z、0-9 的可打印字符）。
[[:space:]]：空格、Tab、LF（10）、VT（11）、FF（12）、CR（13）。
[[:upper:]]：匹配任意大写字母 A-Z。
[[:xdigit:]]：16进制字符（A-F、a-f、0-9）。
请看下面的例子。</p> <p>$ echo [[:upper:]]*
上面命令输出所有大写字母开头的文件名。</p> <p>字符类的第一个方括号后面，可以加上感叹号!，表示否定。比如，[![:digit:]]匹配所有非数字。</p> <p>$ echo [![:digit:]]*
上面命令输出所有不以数字开头的文件名。</p> <p>字符类也属于文件名扩展，如果没有匹配的文件名，字符类就会原样输出。</p> <p>$ echo [[:upper:]]*
[[:upper:]]*
上面例子中，由于没有可匹配的文件，字符类就原样输出了。</p> <p>使用注意点 #
通配符有一些使用注意点，不可不知。</p> <p>（1）通配符是先解释，再执行。</p> <p>Bash 接收到命令以后，发现里面有通配符，会进行通配符扩展，然后再执行命令。</p> <p>$ ls a*.txt
ab.txt
上面命令的执行过程是，Bash 先将a*.txt扩展成ab.txt，然后再执行ls ab.txt。</p> <p>（2）文件名扩展在不匹配时，会原样输出。</p> <p>文件名扩展在没有可匹配的文件时，会原样输出。</p> <p>$ echo r*
r*
上面代码中，由于不存在r开头的文件名，r*会原样输出。</p> <p>下面是另一个例子。</p> <p>$ ls *.csv
ls: *.csv: No such file or directory
另外，前面已经说过，大括号扩展{...}不是文件名扩展。</p> <p>（3）只适用于单层路径。</p> <p>所有文件名扩展只匹配单层路径，不能跨目录匹配，即无法匹配子目录里面的文件。或者说，?或*这样的通配符，不能匹配路径分隔符（/）。</p> <p>如果要匹配子目录里面的文件，可以写成下面这样。</p> <p>$ ls <em>/</em>.txt
Bash 4.0 新增了一个globstar参数，允许**匹配零个或多个子目录，详见后面shopt命令的介绍。</p> <p>（4）文件名可以使用通配符。</p> <p>Bash 允许文件名使用通配符，即文件名包括特殊字符。这时引用文件名，需要把文件名放在单引号里面。</p> <p>$ touch 'fo*'
$ ls
fo*
上面代码创建了一个fo<em>文件，这时</em>就是文件名的一部分。</p> <p>量词语法 #
量词语法用来控制模式匹配的次数。它只有在 Bash 的extglob参数打开的情况下才能使用，不过一般是默认打开的。下面的命令可以查询。</p> <p>$ shopt extglob
extglob         on
量词语法有下面几个。</p> <p>?(pattern-list)：匹配零个或一个模式。
*(pattern-list)：匹配零个或多个模式。
+(pattern-list)：匹配一个或多个模式。
@(pattern-list)：只匹配一个模式。
!(pattern-list)：匹配零个或一个以上的模式，但不匹配单独一个的模式。
$ ls abc?(.)txt
abctxt abc.txt
上面例子中，?(.)匹配零个或一个点。</p> <p>$ ls abc?(def)
abc abcdef
上面例子中，?(def)匹配零个或一个def。</p> <p>$ ls abc+(.txt|.php)
abc.php abc.txt
上面例子中，+(.txt|.php)匹配文件有一个.txt或.php后缀名。</p> <p>$ ls abc+(.txt)
abc.txt abc.txt.txt
上面例子中，+(.txt)匹配文件有一个或多个.txt后缀名。</p> <p>量词语法也属于文件名扩展，如果不存在可匹配的文件，就会原样输出。</p> <p>$ ls abc?(def)
ls: 无法访问'abc?(def)': 没有那个文件或目录
上面例子中，由于没有可匹配的文件，abc?(def)就原样输出，导致ls命令报错。</p> <p>shopt 命令 #
shopt命令可以调整 Bash 的行为。它有好几个参数跟通配符扩展有关。</p> <p>shopt命令的使用方法如下。</p> <p>$ shopt -s [optionname]</p> <p>$ shopt -u [optionname]</p> <p>$ shopt [optionname]
（1）dotglob 参数</p> <p>dotglob参数可以让扩展结果包括隐藏文件（即点开头的文件）。</p> <p>正常情况下，扩展结果不包括隐藏文件。</p> <p>$ ls *
abc.txt
打开dotglob，就会包括隐藏文件。</p> <p>$ shopt -s dotglob
$ ls *
abc.txt .config
（2）nullglob 参数</p> <p>nullglob参数可以让通配符不匹配任何文件名时，返回空字符。</p> <p>默认情况下，通配符不匹配任何文件名时，会保持不变。</p> <p>$ rm b*
rm: 无法删除'b*': 没有那个文件或目录
上面例子中，由于当前目录不包括b开头的文件名，导致b<em>不会发生文件名扩展，保持原样不变，所以rm命令报错没有b</em>这个文件。</p> <p>打开nullglob参数，就可以让不匹配的通配符返回空字符串。</p> <p>$ shopt -s nullglob
$ rm b*
rm: 缺少操作数
上面例子中，由于没有b<em>匹配的文件名，所以rm b</em>扩展成了rm，导致报错变成了”缺少操作数“。</p> <p>（3）failglob 参数</p> <p>failglob参数使得通配符不匹配任何文件名时，Bash 会直接报错，而不是让各个命令去处理。</p> <p>$ shopt -s failglob
$ rm b*
bash: 无匹配: b*
上面例子中，打开failglob以后，由于b*不匹配任何文件名，Bash 直接报错了，不再让rm命令去处理。</p> <p>（4）extglob 参数</p> <p>extglob参数使得 Bash 支持 ksh 的一些扩展语法。它默认应该是打开的。</p> <p>$ shopt extglob
extglob         on
它的主要应用是支持量词语法。如果不希望支持量词语法，可以用下面的命令关闭。</p> <p>$ shopt -u extglob
（5）nocaseglob 参数</p> <p>nocaseglob参数可以让通配符扩展不区分大小写。</p> <p>$ shopt -s nocaseglob
$ ls /windows/program*
/windows/ProgramData
/windows/Program Files
/windows/Program Files (x86)
上面例子中，打开nocaseglob以后，program*就不区分大小写了，可以匹配ProgramData等。</p> <p>（6）globstar 参数</p> <p>globstar参数可以使得**匹配零个或多个子目录。该参数默认是关闭的。</p> <p>假设有下面的文件结构。</p> <p>a.txt
sub1/b.txt
sub1/sub2/c.txt
上面的文件结构中，顶层目录、第一级子目录sub1、第二级子目录sub1\sub2里面各有一个文本文件。请问怎样才能使用通配符，将它们显示出来？</p> <p>默认情况下，只能写成下面这样。</p> <p>$ ls <em>.txt <em>/</em>.txt <em>/</em>/</em>.txt
a.txt  sub1/b.txt  sub1/sub2/c.txt
这是因为*只匹配当前目录，如果要匹配子目录，只能一层层写出来。</p> <p>打开globstar参数以后，<strong>匹配零个或多个子目录。因此，</strong>/*.txt就可以得到想要的结果。</p> <p>$ shopt -s globstar
$ ls **/*.txt
a.txt  sub1/b.txt  sub1/sub2/c.txt
参考链接 #
Think You Understand Wildcards? Think Again
Advanced Wildcard Patterns Most People Don’t Know</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/21/2020, 5:55:25 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/source-files/shell/基本语法.html" class="prev">
        基本语法
      </a></span> <span class="next"><a href="/source-files/shell/条件判断.html">
        条件判断
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/source-files/assets/js/app.0b8b2e65.js" defer></script><script src="/source-files/assets/js/2.6ef31ef9.js" defer></script><script src="/source-files/assets/js/13.8532f00c.js" defer></script>
  </body>
</html>
